<!-- Set this_pages_navbar  -->












<!Doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="http://tigera-docs.appspot.com//images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="http://tigera-docs.appspot.com//css/style.css"/>
    <link rel="stylesheet" href="http://tigera-docs.appspot.com//css/plugins/offcanvas.css"/>
    <link href="https://www.projectcalico.org/wp-content/themes/dante/css/font-awesome.min.css" rel="stylesheet">
    <script src="http://tigera-docs.appspot.com//js/jquery-2.2.0.min.js"></script>
    <script src="http://tigera-docs.appspot.com//js/bootstrap/bootstrap.min.js"></script>
    <script src="http://tigera-docs.appspot.com//js/script.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52125893-4', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Configuring Calico</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Configuring Calico" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://docs.projectcalico.org/http://tigera-docs.appspot.com/v1.6/usage/configuration/" />
<meta property="og:url" content="https://docs.projectcalico.org/http://tigera-docs.appspot.com/v1.6/usage/configuration/" />
<script type="application/ld+json">
{"headline":"Configuring Calico","@type":"WebPage","url":"https://docs.projectcalico.org/http://tigera-docs.appspot.com/v1.6/usage/configuration/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <section>
      <nav id="toplevel-nav" class="navbar navbar-default navbar-static-top">
        <div class="container">
          <div class="navbar-header">
            <!-- Hamburger menu for mobile -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#tigera-navbar" aria-expanded="false" aria-controls="tigera-navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <!-- Left brand image -->
            <a class="navbar-brand" href="https://projectcalico.org/">
              <img alt="Brand" src="http://tigera-docs.appspot.com//images/brand.png">
            </a>
          </div>
          <div id="tigera-navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://projectcalico.org">Home</a></li>
              <li class="active"><a href="https://projectcalico.org/resources"><span>Resources</span></a>
                <ul>
                    <li><a href="http://tigera-docs.appspot.com//latest/getting-started/"><i class="fa fa-tachometer" aria-hidden="true"></i> &nbsp; Getting Started</a></li>
                    <li><a href="http://tigera-docs.appspot.com/"><i class="fa fa-book" aria-hidden="true"></i> &nbsp; Documentation</a></li>
                    <!--<li><a href="https://www.projectcalico.org/tutorials"><i class="fa fa-file-code-o" aria-hidden="true"></i> &nbsp; Tutorials &amp; Examples</a></li>
                    <li><a href=""><i class="fa fa-paper-plane-o" aria-hidden="true"></i> &nbsp; Online Workshops</a></li>-->
                    <li><a href="https://www.projectcalico.org/videos"><i class="fa fa-video-camera" aria-hidden="true"></i> &nbsp; Videos &amp; Webinars</a></li>
                    <li><a href="https://www.projectcalico.org/training"><i class="fa fa-graduation-cap" aria-hidden="true"></i> &nbsp; Training</a></li>
                    <li><a href="http://tigera-docs.appspot.com//latest/releases/"><i class="fa fa-clock-o" aria-hidden="true"></i> &nbsp; Releases</a></li>
                    <!-- <li><a href="/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li> -->
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/community">Community</a>
                <ul>
                    <li><a href="https://slack.projectcalico.org/"><i class="fa fa-slack" aria-hidden="true"></i> &nbsp; Slack</a></li>
                    <!--<li><a href="https://stackoverflow.com/questions/tagged/project-calico" target="_blank"><i class="fa fa-stack-overflow" aria-hidden="true"></i> &nbsp; StackOverflow</a></li>-->
                    <li><a href="https://www.projectcalico.org/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li>
                    <li><a href="https://www.projectcalico.org/community#events"><i class="fa fa-calendar" aria-hidden="true"></i> &nbsp; Upcoming Events</a></li>
                    <li><a href="https://www.projectcalico.org/newsletters"><i class="fa fa-envelope-o" aria-hidden="true"></i> &nbsp; Newsletter</a></li>
                    <li><a href="https://github.com/projectcalico" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> &nbsp; GitHub</a></li> 
                    <li><a href="https://www.projectcalico.org/jobs"><i class="fa fa-briefcase" aria-hidden="true"></i> &nbsp; Jobs</a></li>
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/mvp" style="font-weight: bold;">MVP</a></li>
              <li><a href="https://www.projectcalico.org/support">Support</a></li>
              <li class="hidden-xs"><a href="https://www.projectcalico.org/support">
                <img class="desktopImage" width="30" align="absmiddle" src="https://www.projectcalico.org/images/tigera_trans_sm.png" alt="Tigera"></a>
              </li>
            </ul>
            <form class="navbar-form visible-xs">
              <ul class="nav navbar-nav navbar-right">
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v1.6/introduction">Introduction</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v1.6/getting-started">Getting Started</a>
                  </li>
                
                  <li  class="active">
                    <a href="http://tigera-docs.appspot.com//v1.6/usage">Usage</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v1.6/reference">Reference</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v1.6/releases">Releases</a>
                  </li>
                
              </ul>
            </form>
            <ul class="visible-xs nav navbar-nav navbar-right">
             <li class="dropdown">
               <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v1.6)<span class="caret"></span></a>
               <ul class="dropdown-menu">
                 <li><a href="http://tigera-docs.appspot.com//v2.6/introduction">v2.6 (latest)</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.5/introduction">v2.5</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.4/introduction">v2.4</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.3/introduction">v2.3</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.2/introduction">v2.2</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.1/introduction">v2.1</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.0/introduction">v2.0</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v1.6/introduction">v1.6</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v1.5/introduction">v1.5</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v3.0/introduction">v3.0 (beta)</a></li>
                 <li><a href="http://tigera-docs.appspot.com//master/introduction">nightly</a></li>
                 <li role="separator" class="divider"></li>
               </ul>
             </li>
           </ul>
          </div>
        </div>
        <div id="navbar" class="navbar-inverse navbar-collapse collapse">
          <div class="container">
            <ul class="nav navbar-nav">
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v1.6/introduction"><span>Introduction</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v1.6/getting-started"><span>Getting Started</span></a>
                </li>
              
                <li class="active">
                  <a href="http://tigera-docs.appspot.com//v1.6/usage"><span>Usage</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v1.6/reference"><span>Reference</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v1.6/releases"><span>Releases</span></a>
                </li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v1.6)<span class="caret"></span></a>
                <ul class="dropdown-menu">
                   <li><a href="http://tigera-docs.appspot.com//v3.0/introduction">v3.0 (latest)</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.6/introduction">v2.6</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.5/introduction">v2.5</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.4/introduction">v2.4</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.3/introduction">v2.3</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.2/introduction">v2.2</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.1/introduction">v2.1</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.0/introduction">v2.0</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v1.6/introduction">v1.6</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v1.5/introduction">v1.5</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="http://tigera-docs.appspot.com//master/introduction">nightly</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="row">
            <div class="col-sm-0"></div>
          </div>
        </div>
      </nav>
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
          <p class="pull-left visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
          </p>
          <div class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
            <div class="row">
              <script>
                (function() {
                  var cx = '015028447179048192876:xjzskk7awwe';
                  var gcse = document.createElement('script');
                  gcse.type = 'text/javascript';
                  gcse.async = true;
                  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                  var s = document.getElementsByTagName('script')[0];
                  s.parentNode.insertBefore(gcse, s);
                })();
              </script>
              <gcse:search></gcse:search>
            </div>
            <div id="sidebar">
            	

  
    
    
    <div class="link">
      <a class="item" data-title="Using Calico" href="http://tigera-docs.appspot.com//v1.6/usage/">
        Using Calico
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuration" href="http://tigera-docs.appspot.com//v1.6/usage/configuration/">
        Configuration
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Advanced Network Policy" href="http://tigera-docs.appspot.com//v1.6/usage/configuration/advanced-network-policy">
        Advanced Network Policy
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Calico and Systemd" href="http://tigera-docs.appspot.com//v1.6/usage/configuration/as-service">
        Calico and Systemd
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="BGP Peering" href="http://tigera-docs.appspot.com//v1.6/usage/configuration/bgp">
        BGP Peering
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Route Reflector" href="http://tigera-docs.appspot.com//v1.6/usage/bird-rr-config">
        Route Reflector
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Securing Calico" href="http://tigera-docs.appspot.com//v1.6/usage/configuration/securing-calico">
        Securing Calico
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="IPv6" href="http://tigera-docs.appspot.com//v1.6/usage/ipv6">
        IPv6
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Dockerless Calico" href="http://tigera-docs.appspot.com//v1.6/usage/dockerless-calico">
        Dockerless Calico
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="External Connectivity" href="http://tigera-docs.appspot.com//v1.6/usage/external-connectivity">
        External Connectivity
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Exposing Ports" href="http://tigera-docs.appspot.com//v1.6/usage/exposing-ports">
        Exposing Ports
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Troubleshooting" href="http://tigera-docs.appspot.com//v1.6/usage/troubleshooting/">
        Troubleshooting
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Logging" href="http://tigera-docs.appspot.com//v1.6/usage/troubleshooting/logging">
        Logging
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="FAQ for Calico on Openstack" href="http://tigera-docs.appspot.com//v1.6/usage/troubleshooting/faq">
        FAQ for Calico on Openstack
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="FAQ for Calico in Containers" href="http://tigera-docs.appspot.com//v1.6/usage/troubleshooting/faq-2">
        FAQ for Calico in Containers
      </a>
    </div>
  


			</div>
          </div>
          <div class="col-xs-12 col-sm-8 col-md-9">
            <div id="content-main">
              <!-- TOP DOCUMENTATION PAGE NAVBAR -->
              <div style="text-align: left; padding: 18px 0 9px 0; min-width: 500px; overflow-x: hidden;">
              
              <a data-proofer-ignore href="https://github.com/projectcalico/calico/tree/master/v1.6/usage/configuration/index.md" style="color: #999; text-decoration: none; float: right;" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit this page</a></div>
              <!-- END TOP DOCUMENTATION PAGE NAVBAR -->
              
  <div class="alert alert-warning" role="alert">
    <strong>Warning:</strong> You are viewing the v1.6 docs. <a href="http://tigera-docs.appspot.com//latest">Click here to view the docs for the latest release.</a>
  </div>


              <h1>Configuring Calico</h1>
              <p>This page describes how to configure Calico. We first describe the
configuration of the core Calico component – Felix –because this is
needed, and configured similarly, regardless of the surrounding
environment (OpenStack, Docker, or whatever). Then, depending on that
surrounding environment, there will be some further configuration of
that environment needed, to tell it to talk to the Calico components.</p>

<p>Currently we have detailed environment configuration only for OpenStack.
Work on other environments is in progress, and this page will be
extended as that happens.</p>

<p>This page aims to be a complete Calico configuration reference, and
hence to describe all the possible fields, files etc. For a more
task-based approach, when installing Calico with OpenStack on Ubuntu or
Red Hat, please see our <a href="http://tigera-docs.appspot.com//v1.6/getting-started/openstack/installation/ubuntu">Ubuntu</a> or <a href="http://tigera-docs.appspot.com//v1.6/getting-started/openstack/installation/redhat">Red Hat</a>  installation guides.</p>

<h2 id="system-configuration">System configuration</h2>

<p>A common problem on Linux systems is running out of space in the
conntrack table, which can cause poor iptables performance. This can
happen if you run a lot of workloads on a given host, or if your
workloads create a lot of TCP connections or bidirectional UDP streams.</p>

<p>To avoid this becoming a problem, we recommend increasing the conntrack
table size. To do so, run the following commands:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sysctl -w net.netfilter.nf_conntrack_max=1000000
echo "net.netfilter.nf_conntrack_max=1000000" &gt;&gt; /etc/sysctl.conf
</code></pre></div></div>

<h2 id="felix-configuration">Felix configuration</h2>

<p>The core Calico component is Felix. (Please see <a href="http://tigera-docs.appspot.com//v1.6/reference/architecture">this document</a> for more on  the Calico architecture.)</p>

<p>Configuration for Felix is read from one of four possible locations, in
order, as follows.</p>

<ol>
  <li>Environment variables.</li>
  <li>The Felix configuration file.</li>
  <li>Host specific configuration in etcd.</li>
  <li>Global configuration in etcd.</li>
</ol>

<p>The value of any configuration parameter is the value read from the
<em>first</em> location containing a value. If not set in any of these
locations, most configuration parameters have defaults, and it should be
rare to have to explicitly set them.</p>

<p>In OpenStack, we recommend putting all configuration into configuration
files, since the etcd database is transient (and may be recreated by the
OpenStack plugin in certain error cases). However, in a Docker
environment the use of environment variables or etcd is often more
convenient.</p>

<p>The full list of parameters which can be set is as follows.</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Default</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>EtcdAddr</td>
      <td>localhost:4001</td>
      <td>The location (IP / hostname and port) of the etcd node or proxy that Felix should connect to.</td>
    </tr>
    <tr>
      <td>EtcdScheme</td>
      <td>http</td>
      <td>The protocol type (http or https) of the etcd node or proxy that Felix connects to.</td>
    </tr>
    <tr>
      <td>EtcdKeyFile</td>
      <td>None</td>
      <td>The full path to the etcd public key file, as described in usingtlswithetcd</td>
    </tr>
    <tr>
      <td>EtcdCertFile</td>
      <td>None</td>
      <td>The full path to the etcd certificate file, as described in usingtlswithetcd</td>
    </tr>
    <tr>
      <td>EtcdCaFile</td>
      <td>“/etc/ssl/certs/ca-certificates.crt”</td>
      <td>The full path to the etcd Certificate Authority certificate file, as described in usingtlswithetcd. The default value is the standard location of the system trust store. To disable authentication of the server by Felix, set the value to “none”.</td>
    </tr>
    <tr>
      <td>DefaultEndpointToHostAction</td>
      <td>DROP</td>
      <td>By default Calico blocks traffic from   endpoints to the host itself by using   an iptables DROP action. If you want to allow some or all traffic from endpoint to host then set this parameter to “RETURN” (which causes the rest of the  iptables INPUT chain to be processed)   or “ACCEPT” (which immediately accepts  packets).</td>
    </tr>
    <tr>
      <td>FelixHostname</td>
      <td>socket.gethostname()</td>
      <td>The hostname Felix reports to the plugin. Should be used if the hostname  Felix autodetects is incorrect or does  not match what the plugin will expect.</td>
    </tr>
    <tr>
      <td>MetadataAddr</td>
      <td>127.0.0.1</td>
      <td>The IP address or domain name of the server that can answer VM queries for  cloud-init metadata. In OpenStack, thiscorresponds to the machine running     nova-api (or in Ubuntu, nova-api-metadata). A value of ‘None’  (case insensitive) means that Felix should not set up any NAT rule for the metadata path.</td>
    </tr>
    <tr>
      <td>MetadataPort</td>
      <td>8775</td>
      <td>The port of the metadata server. This, combined with global.MetadataAddr (if  not ‘None’), is used to set up a NAT   rule, from 169.254.169.254:80 to       MetadataAddr:MetadataPort. In most cases this should not need to be       changed.</td>
    </tr>
    <tr>
      <td>InterfacePrefix</td>
      <td>cali</td>
      <td>The expected prefix for interface names for workload interfaces. For example,   in OpenStack deployments, this should   be set to “tap”. Calico polices all     traffic to/from interfaces with this    prefix. Calico blocks traffic to/from   such interfaces by default.</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>LogFilePath</td>
      <td>/var/log/calico/felix.log</td>
      <td>The full path to the felix log. Set to “none” to disable file logging.</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>EtcdDriverLogFilePath</td>
      <td>/var/log/calico/felix.log</td>
      <td>Felix’s etcd driver has its own log file. This parameter contains its full path.</td>
    </tr>
    <tr>
      <td>LogSeveritySys</td>
      <td>ERROR</td>
      <td>The log severity above which logs are sent to the syslog. Valid values are  DEBUG, INFO, WARNING, ERROR and       CRITICAL, or NONE for no logging to   syslog (all values case insensitive).</td>
    </tr>
    <tr>
      <td>LogSeverityFile</td>
      <td>INFO</td>
      <td>The log severity above which logs are sent to the log file. Valid values as for LogSeveritySys.</td>
    </tr>
    <tr>
      <td>LogSeverityScreen</td>
      <td>ERROR</td>
      <td>The log severity above which logs are sent to the stdout. Valid values as for LogSeveritySys.</td>
    </tr>
    <tr>
      <td>StartupCleanupDelay</td>
      <td>30</td>
      <td>Delay, in seconds, before felix does its start-of-day cleanup to remove  orphaned iptables chains and ipsets.  Before the first cleanup, felix     operates in “graceful restart” mode,  during which it preserves any      pre-existing chains and ipsets. In a large deployment you may want to  increase this value to give felix more  time to load the initial snapshot from  etcd before cleaning up.</td>
    </tr>
    <tr>
      <td>PeriodicResyncInterval</td>
      <td>3600</td>
      <td>Period, in seconds, at which felix does a full resync with etcd and reprograms iptables/ipsets. Set to 0 to disable periodic resync.</td>
    </tr>
    <tr>
      <td>IptablesRefreshInterval</td>
      <td>60</td>
      <td>Period, in seconds, at which felix re-applies all iptables state to ensure that no other process has accidentally broken Calico’s rules. Set to 0 to disable iptables refresh.</td>
    </tr>
    <tr>
      <td>MaxIpsetSize</td>
      <td>1048576</td>
      <td>Maximum size for the ipsets used by      Felix to implement tags. Should be set   to a number that is greater than the     maximum number of IP addresses that are  ever expected in a tag.</td>
    </tr>
    <tr>
      <td>IptablesMarkMask</td>
      <td>0xff000000</td>
      <td>Mask that Felix selects its IPTables Mark bits from. Should be a 32 bit       hexadecimal number with at least 8 bits  set, none of which clash with any other  mark bits in use on the system.</td>
    </tr>
    <tr>
      <td>PrometheusMetricsEnabled</td>
      <td>“false”</td>
      <td>Set to “true” to enable the experimental Prometheus metrics server in Felix.</td>
    </tr>
    <tr>
      <td>PrometheusMetricsPort</td>
      <td>9091</td>
      <td>TCP port that the Prometheus metrics server should bind to.</td>
    </tr>
    <tr>
      <td>EtcdDriverPrometheusMetricsPort</td>
      <td>9092</td>
      <td>TCP port that the Prometheus metrics server in the etcd driver process should bind to.</td>
    </tr>
    <tr>
      <td>UsageReportingEnabled</td>
      <td>“true”</td>
      <td>Reports anonymous Calico version number and cluster size to projectcalico.org.  Logs warnings returned by the usage server. For example, if a significant security vulnerability has been discovered in the version of Calico being used.</td>
    </tr>
    <tr>
      <td>FailsafeInboundHostPorts</td>
      <td>22</td>
      <td>Comma-delimited list of TCP ports that Felix will allow incoming traffic to host endpoints on irrespective of the security policy. To disable all inbound host ports, use the value “none”. This is useful to avoid accidently cutting off a host with incorrect configuration. The default value allows ssh access.</td>
    </tr>
    <tr>
      <td>FailsafeOutboundHostPorts</td>
      <td>2379,2380,4001,7001</td>
      <td>Comma-delimited list of TCP ports that Felix will allow outgoing from traffic from host endpoints to irrespective of the security policy. To disable all outbound host ports, use the value “none”. This is useful to avoid accidently cutting off a host with incorrect configuration. The default value opens etcd’s standard ports to ensure that Felix does not get cut off from etcd.</td>
    </tr>
  </tbody>
</table>

<h2 id="environment-variables">Environment variables</h2>

<p>The highest priority of configuration is that read from environment
variables. To set a configuration parameter via an environment variable,
set the environment variable formed by taking <code class="highlighter-rouge">FELIX_</code> and appending the
uppercase form of the variable name. For example, to set the etcd
address, set the environment variable <code class="highlighter-rouge">FELIX_ETCDADDR</code>. Other examples
include <code class="highlighter-rouge">FELIX_ETCDSCHEME</code>, <code class="highlighter-rouge">FELIX_ETCDKEYFILE</code>, <code class="highlighter-rouge">FELIX_ETCDCERTFILE</code>,
<code class="highlighter-rouge">FELIX_ETCDCAFILE</code>, <code class="highlighter-rouge">FELIX_FELIXHOSTNAME</code>, <code class="highlighter-rouge">FELIX_LOGFILEPATH</code> and
<code class="highlighter-rouge">FELIX_METADATAADDR</code>.</p>

<h3 id="configuration-file">Configuration file</h3>

<p>On startup, Felix reads an ini-style configuration file. The path to
this file defaults to <code class="highlighter-rouge">/etc/calico/felix.cfg</code> but can be overridden
using the <code class="highlighter-rouge">-c</code> or <code class="highlighter-rouge">--config-file</code> options on the command line. If the
file exists, then it is read (ignoring section names) and all parameters
are set from it.</p>

<h3 id="etcd-configuration">etcd configuration</h3>

<blockquote>
  <p><strong>NOTE</strong></p>

  <dl>
    <dt>etcd configuration cannot be used to set either EtcdAddr or</dt>
    <dd>
      <p>FelixHostname, both of which are required before the etcd
configuration can be read.</p>
    </dd>
  </dl>

</blockquote>

<p>etcd configuration is read from etcd from two places.</p>

<ol>
  <li>For a host of FelixHostname value <code class="highlighter-rouge">HOSTNAME</code> and a parameter named
<code class="highlighter-rouge">NAME</code>, it is read from <code class="highlighter-rouge">/calico/v1/host/HOSTNAME/config/NAME</code>.</li>
  <li>For a parameter named <code class="highlighter-rouge">NAME</code>, it is read from
<code class="highlighter-rouge">/calico/v1/config/NAME</code>.</li>
</ol>

<p>Note that the names are case sensitive.</p>

<h2 id="openstack-environment-configuration">OpenStack environment configuration</h2>

<p>When running Calico with OpenStack, you also need to configure various
OpenStack components, as follows.</p>

<h3 id="nova-etcnovanovaconf">Nova (/etc/nova/nova.conf)</h3>

<p>Calico uses the Nova metadata service to provide metadata to VMs,
without any proxying by Neutron. To make that work:</p>

<ul>
  <li>An instance of the Nova metadata API must run on every compute node.</li>
  <li><code class="highlighter-rouge">/etc/nova/nova.conf</code> must not set <code class="highlighter-rouge">service_neutron_metadata_proxy</code>
or <code class="highlighter-rouge">service_metadata_proxy</code> to <code class="highlighter-rouge">True</code>. (The default <code class="highlighter-rouge">False</code> value is
correct for a Calico cluster.)</li>
</ul>

<h3 id="neutron-server-etcneutronneutronconf">Neutron server (/etc/neutron/neutron.conf)</h3>

<p>In <code class="highlighter-rouge">/etc/neutron/neutron.conf</code> you need the following settings to
configure the Neutron service.</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>core_plugin</td>
      <td>neutron.plugins.ml2.plugin.ML2Plugin</td>
      <td>Use ML2 plugin</td>
    </tr>
  </tbody>
</table>

<p>With OpenStack releases earlier than Liberty you will also need:</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>dhcp_agents_per_network</td>
      <td>9999</td>
      <td>Allow unlimited DHCP agents per network</td>
    </tr>
  </tbody>
</table>

<p>Optionally – depending on how you want the Calico mechanism driver to
connect to the Etcd cluster – you can also set the following options in
the <code class="highlighter-rouge">[calico]</code> section of <code class="highlighter-rouge">/etc/neutron/neutron.conf</code>.</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Default Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>etcd_host</td>
      <td>localhost</td>
      <td>The hostname or IP of the etcd node/proxy</td>
    </tr>
    <tr>
      <td>etcd_port</td>
      <td>4001</td>
      <td>The port to use for the etcd node/proxy</td>
    </tr>
  </tbody>
</table>

<h3 id="ml2-ml2_confini">ML2 (…/ml2_conf.ini)</h3>

<p>In <code class="highlighter-rouge">/etc/neutron/plugins/ml2/ml2_conf.ini</code> you need the following
settings to configure the ML2 plugin.</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>mechanism_drivers</td>
      <td>calico</td>
      <td>Use Calico</td>
    </tr>
    <tr>
      <td>type_drivers</td>
      <td>local, flat</td>
      <td>Allow ‘local’ and ‘flat’ networks</td>
    </tr>
    <tr>
      <td>tenant_network_types</td>
      <td>local, flat</td>
      <td>Allow ‘local’ and ‘flat’ networks</td>
    </tr>
  </tbody>
</table>

<h2 id="dhcp-agent-dhcp_agentini">DHCP agent (…/dhcp_agent.ini)</h2>

<p>With OpenStack releases earlier than Liberty, in
<code class="highlighter-rouge">/etc/neutron/dhcp_agent.ini</code> you need the following setting to
configure the Neutron DHCP agent.</p>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>interface_driver</td>
      <td>RoutedInterfaceDriver</td>
      <td>Use Calico’s modified DHCP agent support for TAP interfaces that are routed instead of being bridged</td>
    </tr>
  </tbody>
</table>

              
              <!-- BOTTOM DOCUMENTATION PAGE NAVBAR -->
              <div style="margin-top: 60px; margin-bottom: 40px; padding-top: 20px; border-top: 1px solid #999; text-align: left; color: #999;">Rate this Page: <div class="rw-ui-container" style="margin-top: -5px;"></div> <a href="https://www.projectcalico.org/contact?type=docs&file=v1.6/usage/configuration/index.md" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i> Provide Feedback</a> <a href="https://www.projectcalico.org/community#slack" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-slack" aria-hidden="true"></i> Get Help via Slack</a> <a href="https://www.projectcalico.org/mvp" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-trophy" aria-hidden="true"></i> Ask our MVPs</a> <a href="https:/tigera.io/training" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Training</a></div>
              <!-- END BOTTOM DOCUMENTATION PAGE NAVBAR -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Start Visual Website Optimizer Asynchronous Code -->
    <script type='text/javascript'>
      var _vwo_code=(function(){
      var account_id=287573,
      settings_tolerance=2000,
      library_tolerance=2500,
      use_existing_jquery=false,
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
    </script>
    <!-- End Visual Website Optimizer Asynchronous Code -->
    <!-- DOCUMENTATION RATING ANALYTICS -->
   <script type="text/javascript">(function(d, t, e, m){
    // Async Rating-Widget initialization.
    window.RW_Async_Init = function(){
        RW.init({
            huid: "368439",
            uid: "33da22c0dff384767b5074aaf10ebc50",
            source: "website",
            options: {
                "advanced": {
					"font": {
						"color": "#999999"
					},
                    "layout": {
                        "align": {
                            "hor": "left"
                        }
                    },
                    "text": {
                        "rateThis": "Rate this"
                    }
                },
				"label": {
					"background": "#FFFFFF"
				},
				"reVote": true,
				"showInfo": false,
				/*"showTooltip": false,*/
				"hideRecommendations": false,
				"showReport": false,
				"showLoader": false,
                "style": "oxygen",
                "isDummy": false
            } 
        });
        RW.render();
    };
        // Append Rating-Widget JavaScript library.
    var rw, s = d.getElementsByTagName(e)[0], id = "rw-js",
        l = d.location, ck = "Y" + t.getFullYear() + 
        "M" + t.getMonth() + "D" + t.getDate(), p = l.protocol,
        f = ((l.search.indexOf("DBG=") > -1) ? "" : ".min"),
        a = ("https:" == p ? "secure." + m + "js/" : "js." + m);
    if (d.getElementById(id)) return;              
    rw = d.createElement(e);
    rw.id = id; rw.async = true; rw.type = "text/javascript";
    rw.src = p + "//" + a + "external" + f + ".js?ck=" + ck;
    s.parentNode.insertBefore(rw, s);
    }(document, new Date(), "script", "rating-widget.com/"));</script>
    <!-- END DOCUMENTATION RATING ANALYTICS -->
  </body>
</html>
