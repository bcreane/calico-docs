<!-- Set this_pages_navbar  -->












<!Doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="http://tigera-docs.appspot.com//images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="http://tigera-docs.appspot.com//css/style.css"/>
    <link rel="stylesheet" href="http://tigera-docs.appspot.com//css/plugins/offcanvas.css"/>
    <link href="https://www.projectcalico.org/wp-content/themes/dante/css/font-awesome.min.css" rel="stylesheet">
    <script src="http://tigera-docs.appspot.com//js/jquery-2.2.0.min.js"></script>
    <script src="http://tigera-docs.appspot.com//js/bootstrap/bootstrap.min.js"></script>
    <script src="http://tigera-docs.appspot.com//js/script.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52125893-4', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Calico over an Ethernet interconnect fabric</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Calico over an Ethernet interconnect fabric" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://docs.projectcalico.org/v3.0/reference/private-cloud/l2-interconnect-fabric" />
<meta property="og:url" content="https://docs.projectcalico.org/v3.0/reference/private-cloud/l2-interconnect-fabric" />
<script type="application/ld+json">
{"headline":"Calico over an Ethernet interconnect fabric","@type":"WebPage","url":"https://docs.projectcalico.org/v3.0/reference/private-cloud/l2-interconnect-fabric","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <section>
      <nav id="toplevel-nav" class="navbar navbar-default navbar-static-top">
        <div class="container">
          <div class="navbar-header">
            <!-- Hamburger menu for mobile -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#tigera-navbar" aria-expanded="false" aria-controls="tigera-navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <!-- Left brand image -->
            <a class="navbar-brand" href="https://projectcalico.org/">
              <img alt="Brand" src="http://tigera-docs.appspot.com//images/brand.png">
            </a>
          </div>
          <div id="tigera-navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://projectcalico.org">Home</a></li>
              <li class="active"><a href="https://projectcalico.org/resources"><span>Resources</span></a>
                <ul>
                    <li><a href="http://tigera-docs.appspot.com//latest/getting-started/"><i class="fa fa-tachometer" aria-hidden="true"></i> &nbsp; Getting Started</a></li>
                    <li><a href="http://tigera-docs.appspot.com/"><i class="fa fa-book" aria-hidden="true"></i> &nbsp; Documentation</a></li>
                    <!--<li><a href="https://www.projectcalico.org/tutorials"><i class="fa fa-file-code-o" aria-hidden="true"></i> &nbsp; Tutorials &amp; Examples</a></li>
                    <li><a href=""><i class="fa fa-paper-plane-o" aria-hidden="true"></i> &nbsp; Online Workshops</a></li>-->
                    <li><a href="https://www.projectcalico.org/videos"><i class="fa fa-video-camera" aria-hidden="true"></i> &nbsp; Videos &amp; Webinars</a></li>
                    <li><a href="https://www.projectcalico.org/training"><i class="fa fa-graduation-cap" aria-hidden="true"></i> &nbsp; Training</a></li>
                    <li><a href="http://tigera-docs.appspot.com//latest/releases/"><i class="fa fa-clock-o" aria-hidden="true"></i> &nbsp; Releases</a></li>
                    <!-- <li><a href="/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li> -->
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/community">Community</a>
                <ul>
                    <li><a href="https://slack.projectcalico.org/"><i class="fa fa-slack" aria-hidden="true"></i> &nbsp; Slack</a></li>
                    <!--<li><a href="https://stackoverflow.com/questions/tagged/project-calico" target="_blank"><i class="fa fa-stack-overflow" aria-hidden="true"></i> &nbsp; StackOverflow</a></li>-->
                    <li><a href="https://www.projectcalico.org/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li>
                    <li><a href="https://www.projectcalico.org/community#events"><i class="fa fa-calendar" aria-hidden="true"></i> &nbsp; Upcoming Events</a></li>
                    <li><a href="https://www.projectcalico.org/newsletters"><i class="fa fa-envelope-o" aria-hidden="true"></i> &nbsp; Newsletter</a></li>
                    <li><a href="https://github.com/projectcalico" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> &nbsp; GitHub</a></li> 
                    <li><a href="https://www.projectcalico.org/jobs"><i class="fa fa-briefcase" aria-hidden="true"></i> &nbsp; Jobs</a></li>
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/mvp" style="font-weight: bold;">MVP</a></li>
              <li><a href="https://www.projectcalico.org/support">Support</a></li>
              <li class="hidden-xs"><a href="https://www.projectcalico.org/support">
                <img class="desktopImage" width="30" align="absmiddle" src="https://www.projectcalico.org/images/tigera_trans_sm.png" alt="Tigera"></a>
              </li>
            </ul>
            <form class="navbar-form visible-xs">
              <ul class="nav navbar-nav navbar-right">
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v2.2/introduction">Introduction</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v2.2/getting-started">Getting Started</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v2.2/usage">Usage</a>
                  </li>
                
                  <li  class="active">
                    <a href="http://tigera-docs.appspot.com//v2.2/reference">Reference</a>
                  </li>
                
                  <li >
                    <a href="http://tigera-docs.appspot.com//v2.2/releases">Releases</a>
                  </li>
                
              </ul>
            </form>
            <ul class="visible-xs nav navbar-nav navbar-right">
             <li class="dropdown">
               <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v2.2)<span class="caret"></span></a>
               <ul class="dropdown-menu">
                 <li><a href="http://tigera-docs.appspot.com//v2.6/introduction">v2.6 (latest)</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.5/introduction">v2.5</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.4/introduction">v2.4</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.3/introduction">v2.3</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.2/introduction">v2.2</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.1/introduction">v2.1</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v2.0/introduction">v2.0</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v1.6/introduction">v1.6</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v1.5/introduction">v1.5</a></li>
                 <li><a href="http://tigera-docs.appspot.com//v3.0/introduction">v3.0 (beta)</a></li>
                 <li><a href="http://tigera-docs.appspot.com//master/introduction">nightly</a></li>
                 <li role="separator" class="divider"></li>
               </ul>
             </li>
           </ul>
          </div>
        </div>
        <div id="navbar" class="navbar-inverse navbar-collapse collapse">
          <div class="container">
            <ul class="nav navbar-nav">
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v2.2/introduction"><span>Introduction</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v2.2/getting-started"><span>Getting Started</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v2.2/usage"><span>Usage</span></a>
                </li>
              
                <li class="active">
                  <a href="http://tigera-docs.appspot.com//v2.2/reference"><span>Reference</span></a>
                </li>
              
                <li>
                  <a href="http://tigera-docs.appspot.com//v2.2/releases"><span>Releases</span></a>
                </li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v2.2)<span class="caret"></span></a>
                <ul class="dropdown-menu">
                   <li><a href="http://tigera-docs.appspot.com//v3.0/introduction">v3.0 (latest)</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.6/introduction">v2.6</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.5/introduction">v2.5</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.4/introduction">v2.4</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.3/introduction">v2.3</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.2/introduction">v2.2</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.1/introduction">v2.1</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v2.0/introduction">v2.0</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v1.6/introduction">v1.6</a></li>
                   <li><a href="http://tigera-docs.appspot.com//v1.5/introduction">v1.5</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="http://tigera-docs.appspot.com//master/introduction">nightly</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="row">
            <div class="col-sm-0"></div>
          </div>
        </div>
      </nav>
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
          <p class="pull-left visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
          </p>
          <div class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
            <div class="row">
              <script>
                (function() {
                  var cx = '015028447179048192876:xjzskk7awwe';
                  var gcse = document.createElement('script');
                  gcse.type = 'text/javascript';
                  gcse.async = true;
                  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                  var s = document.getElementsByTagName('script')[0];
                  s.parentNode.insertBefore(gcse, s);
                })();
              </script>
              <gcse:search></gcse:search>
            </div>
            <div id="sidebar">
            	

  
    
    
    <div class="link">
      <a class="item" data-title="Reference" href="http://tigera-docs.appspot.com//v2.2/reference/">
        Reference
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Supported Platforms" href="http://tigera-docs.appspot.com//v2.2/reference/supported-platforms">
        Supported Platforms
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl" aria-expanded="false" aria-controls="nav-calicoctl">
          calicoctl
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-commandreference" aria-expanded="false" aria-controls="nav-calicoctl-commandreference">
          Command Reference
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-commandreference">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="create" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/create">
        create
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="replace" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/replace">
        replace
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="apply" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/apply">
        apply
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="delete" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/delete">
        delete
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="get" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/get">
        get
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="config" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/config">
        config
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-commandreference-ipam" aria-expanded="false" aria-controls="nav-calicoctl-commandreference-ipam">
          ipam
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-commandreference-ipam">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/ipam/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="release" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/ipam/release">
        release
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="show" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/ipam/show">
        show
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-commandreference-node" aria-expanded="false" aria-controls="nav-calicoctl-commandreference-node">
          node
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-commandreference-node">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/node/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="run" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/node/run">
        run
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="status" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/node/status">
        status
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="diags" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/node/diags">
        diags
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="checksystem" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/node/checksystem">
        checksystem
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="version" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/commands/version">
        version
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-resourcedefinitions" aria-expanded="false" aria-controls="nav-calicoctl-resourcedefinitions">
          Resource Definitions
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-resourcedefinitions">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="BGP Peer" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/bgppeer">
        BGP Peer
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Host Endpoint" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/hostendpoint">
        Host Endpoint
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="IP Pool" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/ippool">
        IP Pool
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Node" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/node">
        Node
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Policy" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/policy">
        Policy
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Profile" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/profile">
        Profile
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Workload Endpoint" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/resources/workloadendpoint">
        Workload Endpoint
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-setup" aria-expanded="false" aria-controls="nav-calicoctl-setup">
          Setup
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-setup">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/setup/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="etcdv2 datastore" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/setup/etcdv2">
        etcdv2 datastore
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="kubernetes api datastore" href="http://tigera-docs.appspot.com//v2.2/reference/calicoctl/setup/kubernetes">
        kubernetes api datastore
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-caliconode" aria-expanded="false" aria-controls="nav-caliconode">
          calico/node
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-caliconode">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Configuration" href="http://tigera-docs.appspot.com//v2.2/reference/node/configuration">
        Configuration
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-felix" aria-expanded="false" aria-controls="nav-felix">
          felix
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-felix">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Configuration" href="http://tigera-docs.appspot.com//v2.2/reference/felix/configuration">
        Configuration
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Prometheus Statistics" href="http://tigera-docs.appspot.com//v2.2/reference/felix/prometheus">
        Prometheus Statistics
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Calico CNI Plugins" href="http://tigera-docs.appspot.com//v2.2/reference/cni-plugin/configuration">
        Calico CNI Plugins
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Calico Policy Controller" href="http://tigera-docs.appspot.com//v2.2/reference/policy-controller/configuration">
        Calico Policy Controller
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-deployingonpubliccloud" aria-expanded="false" aria-controls="nav-deployingonpubliccloud">
          Deploying on Public Cloud
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-deployingonpubliccloud">
          

  
    
    
    <div class="link">
      <a class="item" data-title="AWS" href="http://tigera-docs.appspot.com//v2.2/reference/public-cloud/aws">
        AWS
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="GCE" href="http://tigera-docs.appspot.com//v2.2/reference/public-cloud/gce">
        GCE
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-deployingonprivatecloud" aria-expanded="false" aria-controls="nav-deployingonprivatecloud">
          Deploying on Private Cloud
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-deployingonprivatecloud">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Calico Over Ethernet Fabrics" href="http://tigera-docs.appspot.com//v2.2/reference/private-cloud/l2-interconnect-fabric">
        Calico Over Ethernet Fabrics
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Calico Over IP Fabrics" href="http://tigera-docs.appspot.com//v2.2/reference/private-cloud/l3-interconnect-fabric">
        Calico Over IP Fabrics
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-architecture" aria-expanded="false" aria-controls="nav-architecture">
          Architecture
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-architecture">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Introduction" href="http://tigera-docs.appspot.com//v2.2/reference/architecture/">
        Introduction
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="calico/node" href="http://tigera-docs.appspot.com//v2.2/reference/architecture/components">
        calico/node
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Data Path" href="http://tigera-docs.appspot.com//v2.2/reference/architecture/data-path">
        Data Path
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-advanced" aria-expanded="false" aria-controls="nav-advanced">
          Advanced
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-advanced">
          

  
    
    
    <div class="link">
      <a class="item" data-title="RBAC for etcdv2" href="http://tigera-docs.appspot.com//v2.2/reference/advanced/etcd-rbac">
        RBAC for etcdv2
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Repo Structure" href="http://tigera-docs.appspot.com//v2.2/reference/repo-structure">
        Repo Structure
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Contribute" href="http://tigera-docs.appspot.com//v2.2/reference/contribute">
        Contribute
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Involved" href="http://tigera-docs.appspot.com//v2.2/reference/involved">
        Involved
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="License" href="http://tigera-docs.appspot.com//v2.2/reference/license">
        License
      </a>
    </div>
  


			</div>
          </div>
          <div class="col-xs-12 col-sm-8 col-md-9">
            <div id="content-main">
              <!-- TOP DOCUMENTATION PAGE NAVBAR -->
              <div style="text-align: left; padding: 18px 0 9px 0; min-width: 500px; overflow-x: hidden;">
              
              <a data-proofer-ignore href="https://github.com/projectcalico/calico/tree/master/v2.2/reference/private-cloud/l2-interconnect-fabric.md" style="color: #999; text-decoration: none; float: right;" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit this page</a></div>
              <!-- END TOP DOCUMENTATION PAGE NAVBAR -->
              
  <div class="alert alert-warning" role="alert">
    <strong>Warning:</strong> You are viewing the v2.2 docs. <a href="http://tigera-docs.appspot.com//latest">Click here to view the docs for the latest release.</a>
  </div>


              <h1>Calico over an Ethernet interconnect fabric</h1>
              <p>This is the first of a few <em>tech notes</em> that I will be authoring that
will discuss some of the various interconnect fabric options in a Calico
network.</p>

<p>Any technology that is capable of transporting IP packets can be used as
the interconnect fabric in a Calico network (the first person to test
and publish the results of using <a href="http://tools.ietf.org/html/rfc1149">IP over Avian
Carrier</a> as a transport for Calico
will earn a very nice dinner on or with the core Calico team). This
means that the standard tools used to transport IP, such as MPLS and
Ethernet can be used in a Calico network.</p>

<p>In this note, I’m going to focus on Ethernet as the interconnect
network. Talking to most at-scale cloud operators, they have converted
to IP fabrics, and as will cover in the next blog post that
infrastructure will work for Calico as well. However, the concerns that
drove most of those operators to IP as the interconnection network in
their pods are largely ameliorated by Project Calico, allowing Ethernet
to be viably considered as a Calico interconnect, even in large-scale
deployments.</p>

<h2 id="concerns-over-ethernet-at-scale">Concerns over Ethernet at scale</h2>

<p>It has been acknowledged by the industry for years that, beyond a
certain size, classical Ethernet networks are unsuitable for production
deployment. Although there have been
<a href="https://en.wikipedia.org/wiki/Provider_Backbone_Bridge_Traffic_Engineering">multiple</a>
<a href="https://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_14-3/143_trill.html">attempts</a> <a href="https://en.wikipedia.org/wiki/Virtual_Private_LAN_Service">to address</a>
these issues, the scale-out networking community has, largely abandoned
Ethernet for anything other than providing physical point-to-point links
in the networking fabric. The principal reasons for Ethernet failures at
large scale are:</p>

<ol>
  <li>Large numbers of <em>end points</em> <sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>. Each switch in an Ethernet
network must learn the path to all Ethernet endpoints that are
connected to the Ethernet network. Learning this amount of state can
become a substantial task when we are talking about hundreds of
thousands of <em>end points</em>.</li>
  <li>High rate of <em>churn</em> or change in the network. With that many end
points, most of them being ephemeral (such as virtual machines or
containers), there is a large amount of <em>churn</em> in the network. That
load of re-learning paths can be a substantial burden on the control
plane processor of most Ethernet switches.</li>
  <li>High volumes of broadcast traffic. As each node on the Ethernet
network must use Broadcast packets to locate peers, and many use
broadcast for other purposes, the resultant packet replication to
each and every end point can lead to <em>broadcast storms</em> in large
Ethernet networks, effectively consuming most, if not all resources
in the network and the attached end points.</li>
  <li>Spanning tree. Spanning tree is the protocol used to keep an
Ethernet network from forming loops. The protocol was designed in
the era of smaller, simpler networks, and it has not aged well. As
the number of links and interconnects in an Ethernet network goes
up, many implementations of spanning tree become more <em>fragile</em>.
Unfortunately, when spanning tree fails in an Ethernet network, the
effect is a catastrophic loop or partition (or both) in the network,
and, in most cases, difficult to troubleshoot or resolve.</li>
</ol>

<p>While many of these issues are crippling at <em>VM scale</em> (tens of
thousands of end points that live for hours, days, weeks), they will be
absolutely lethal at <em>container scale</em> (hundreds of thousands of end
points that live for seconds, minutes, days).</p>

<p>If you weren’t ready to turn off your Ethernet data center network
before this, I bet you are now. Before you do, however, let’s look at
how Project Calico can mitigate these issues, even in very large
deployments.</p>

<h2 id="how-does-calico-tame-the-ethernet-daemons">How does Calico tame the Ethernet daemons?</h2>

<p>First, let’s look at how Calico uses an Ethernet interconnect fabric.
It’s important to remember that an Ethernet network <em>sees</em> nothing on
the other side of an attached IP router, the Ethernet network just
<em>sees</em> the router itself. This is why Ethernet switches can be used at
Internet peering points, where large fractions of Internet traffic is
exchanged. The switches only see the routers from the various ISPs, not
those ISPs’ customers’ nodes. We leverage the same effect in Calico.</p>

<p>To take the issues outlined above, let’s revisit them in a Calico
context.</p>

<ol>
  <li>Large numbers of end points. In a Calico network, the Ethernet
interconnect fabric only sees the routers/compute servers, not the
end point. In a standard cloud model, where there is tens of VMs per
server (or hundreds of containers), this reduces the number of nodes
that the Ethernet sees (and has to learn) by one to two orders
of magnitude. Even in very large pods (say twenty thousand servers),
the Ethernet network would still only see a few tens of thousands of
end points. Well within the scale of any competent data center
Ethernet top of rack (ToR) switch.</li>
  <li>High rate of <em>churn</em>. In a classical Ethernet data center fabric,
there is a <em>churn</em> event each time an end point is created,
destroyed, or moved. In a large data center, with hundreds of
thousands of endpoints, this <em>churn</em> could run into tens of events
per second, every second of the day, with peaks easily in the
hundreds or thousands of events per second. In a Calico network,
however, the <em>churn</em> is very low. The only event that would lead to
<em>churn</em> in a Calico network’s Ethernet fabric would be the addition
or loss of a compute server, switch, or physical connection. In a
twenty thousand server pod, even with a 5% daily failure rate (a few
orders of magnitude more than what is normally experienced), there
would only be two thousand events per <strong>day</strong>. Any switch that can
not handle that volume of change in the network should not be used
for any application.</li>
  <li>High volume of broadcast traffic. Since the first (and last) hop for
any traffic in a Calico network is an IP hop, and IP hops terminate
broadcast traffic, there is no endpoint broadcast network in the
Ethernet fabric, period. In fact, the only broadcast traffic that
should be seen in the Ethernet fabric is the ARPs of the compute
servers locating each other. If the traffic pattern is fairly
consistent, the steady-state ARP rate should be almost zero. Even in
a pathological case, the ARP rate should be well within normal
accepted boundaries.</li>
  <li>Spanning tree. Depending on the architecture chosen for the Ethernet
fabric, it may even be possible to turn off spanning tree. However,
even if it is left on, due to the reduction in node count, and
reduction in churn, most competent spanning tree implementations
should be able to handle the load without stress.</li>
</ol>

<p>With these considerations in mind, it should be evident that an Ethernet
connection fabric in Calico is not only possible, it is practical and
should be seriously considered as the interconnect fabric for a Calico
network.</p>

<p>As mentioned in the IP fabric post, an IP fabric is also quite feasible
for Calico, but there are more considerations that must be taken into
account. The Ethernet fabric option has fewer architectural
considerations in its design.</p>

<h2 id="a-brief-note-about-ethernet-topology">A brief note about Ethernet topology</h2>

<p>As mentioned elsewhere in the Calico documentation, since Calico can use
most of the standard IP tooling, some interesting options regarding
fabric topology become possible.</p>

<p>We assume that an Ethernet fabric for Calico would most likely be
constructed as a <em>leaf/spine</em> architecture. Other options are possible,
but the <em>leaf/spine</em> is the predominant architectural model in use in
scale-out infrastructure today.</p>

<p>Since Calico is an IP routed fabric, a Calico network can use
<a href="https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing">ECMP</a> to
distribute traffic across multiple links (instead of using Ethernet
techniques such as MLAG). By leveraging ECMP load balancing on the
Calico compute servers, it is possible to build the fabric out of
multiple <em>independent</em> leaf/spine planes using no technologies other
than IP routing in the Calico nodes, and basic Ethernet switching in the
interconnect fabric. These planes would operate completely independently
and could be designed such that they would not share a fault domain.
This would allow for the catastrophic failure of one (or more) plane(s)
of Ethernet interconnect fabric without the loss of the pod (the failure
would just decrease the amount of interconnect bandwidth in the pod).
This is a gentler failure mode than the pod-wide IP or Ethernet failure
that is possible with today’s designs.</p>

<p>A more in-depth discussion is possible, so if you’d like, please make a
request, and I will put up a post or white paper. In the meantime, it
may be interesting to venture over to Facebook’s <a href="https://code.facebook.com/posts/360346274145943/introducing-data-center-fabric-the-next-generation-facebook-data-center-network/">blog
post</a>
on their fabric approach. A quick picture to visualize the idea is shown
below.</p>

<p><img src="http://tigera-docs.appspot.com//images/l2-spine-planes.png" alt="A diagram showing the Ethernet spine planes. Each color represents a
distinct Ethernet network, transporting a unique IP
network." /></p>

<p>I am not showing the end points in this diagram, and the end points
would be unaware of anything in the fabric (as noted above).</p>

<p>In the particular case of this diagram, each ToR is segmented into four
logical switches (possibly by using ‘port VLANs’), <sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup> and each compute
server has a connection to each of those logical switches. We will
identify those logical switches by their color. Each ToR would then have
a blue, green, orange, and red logical switch. Those ‘colors’ would be
members of a given <em>plane</em>, so there would be a blue plane, a green
plane, an orange plane, and a red plane. Each plane would have a
dedicated spine switch. and each ToR in a given spine would be connected
to its spine, and only its spine.</p>

<p>Each plane would constitute an IP network, so the blue plane would be
2001:db8:1000::/36, the green would be 2001:db8:2000::/36, and the
orange and red planes would be 2001:db8:3000::/36 and 2001:db8:4000::/36
respectively. <sup id="fnref:3"><a href="#fn:3" class="footnote">3</a></sup></p>

<p>Each IP network (plane) requires it’s own BGP route reflectors. Those
route reflectors need to be peered with each other within the plane, but
the route reflectors in each plane do not need to be peered with one
another. Therefore, a fabric of four planes would have four route
reflector meshes. Each compute server, border router, <em>etc.</em> would need
to be a route reflector client of at least one route reflector in each
plane, and very preferably two or more in each plane.</p>

<p>A diagram that visualizes the route reflector environment can be found
below.</p>

<p><img src="http://tigera-docs.appspot.com//images/l2-rr-spine-planes.png" alt="A diagram showing the route reflector topology in the l2 spine plane
architecture. The dashed diamonds are the route reflectors, with one or
more per L2 spine plane. All compute servers are peered to all route
reflectors, and all the route reflectors in a given plane are also
meshed. However, the route reflectors in each spine plane are not meshed
together (*e.g.* the *blue* route reflectors are not peered or meshed
with the *red* route reflectors. The route reflectors themselves could
be daemons running on the actual compute servers or on other dedicated
or networking hardware." /></p>

<p>These route reflectors could be dedicated hardware connected to the
spine switches (or the spine switches themselves), or physical or
virtual route reflectors connected to the necessary logical leaf
switches (blue, green, orange, and red). That may be a route reflector
running on a compute server and connected directly to the correct plane
link, and not routed through the vRouter, to avoid the chicken and egg
problem that would occur if the route reflector were “behind” the Calico
network.</p>

<p>Other physical and logical configurations and counts are, of course,
possible, this is just an example.</p>

<p>The logical configuration would then have each compute server would have
an address on each plane’s subnet, and announce its end points on each
subnet. If ECMP is then turned on, the compute servers would distribute
the load across all planes.</p>

<p>If a plane were to fail (say due to a spanning tree failure), then only
that one plane would fail. The remaining planes would stay running.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>In this document (and in all Calico documents) we tend to use the
terms <em>end point</em> to refer to a virtual machine, container,
appliance, bare metal server, or any other entity that is connected
to a Calico network. If we are referring to a specific type of end
point, we will call that out (such as referring to the behavior of
VMs as distinct from containers). <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>We are using logical switches in this example. Physical ToRs could
also be used, or a mix of the two (say 2 logical switches hosted on
each physical switch). <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>We use IPv6 here purely as an example. IPv4 would be configured
similarly. I welcome your questions, either here on the blog, or via
the Project Calico mailing list. <a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

              
              <!-- BOTTOM DOCUMENTATION PAGE NAVBAR -->
              <div style="margin-top: 60px; margin-bottom: 40px; padding-top: 20px; border-top: 1px solid #999; text-align: left; color: #999;">Rate this Page: <div class="rw-ui-container" style="margin-top: -5px;"></div> <a href="https://www.projectcalico.org/contact?type=docs&file=v2.2/reference/private-cloud/l2-interconnect-fabric.md" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i> Provide Feedback</a> <a href="https://www.projectcalico.org/community#slack" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-slack" aria-hidden="true"></i> Get Help via Slack</a> <a href="https://www.projectcalico.org/mvp" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-trophy" aria-hidden="true"></i> Ask our MVPs</a> <a href="https:/tigera.io/training" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Training</a></div>
              <!-- END BOTTOM DOCUMENTATION PAGE NAVBAR -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Start Visual Website Optimizer Asynchronous Code -->
    <script type='text/javascript'>
      var _vwo_code=(function(){
      var account_id=287573,
      settings_tolerance=2000,
      library_tolerance=2500,
      use_existing_jquery=false,
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
    </script>
    <!-- End Visual Website Optimizer Asynchronous Code -->
    <!-- DOCUMENTATION RATING ANALYTICS -->
   <script type="text/javascript">(function(d, t, e, m){
    // Async Rating-Widget initialization.
    window.RW_Async_Init = function(){
        RW.init({
            huid: "368439",
            uid: "33da22c0dff384767b5074aaf10ebc50",
            source: "website",
            options: {
                "advanced": {
					"font": {
						"color": "#999999"
					},
                    "layout": {
                        "align": {
                            "hor": "left"
                        }
                    },
                    "text": {
                        "rateThis": "Rate this"
                    }
                },
				"label": {
					"background": "#FFFFFF"
				},
				"reVote": true,
				"showInfo": false,
				/*"showTooltip": false,*/
				"hideRecommendations": false,
				"showReport": false,
				"showLoader": false,
                "style": "oxygen",
                "isDummy": false
            } 
        });
        RW.render();
    };
        // Append Rating-Widget JavaScript library.
    var rw, s = d.getElementsByTagName(e)[0], id = "rw-js",
        l = d.location, ck = "Y" + t.getFullYear() + 
        "M" + t.getMonth() + "D" + t.getDate(), p = l.protocol,
        f = ((l.search.indexOf("DBG=") > -1) ? "" : ".min"),
        a = ("https:" == p ? "secure." + m + "js/" : "js." + m);
    if (d.getElementById(id)) return;              
    rw = d.createElement(e);
    rw.id = id; rw.async = true; rw.type = "text/javascript";
    rw.src = p + "//" + a + "external" + f + ".js?ck=" + ck;
    s.parentNode.insertBefore(rw, s);
    }(document, new Date(), "script", "rating-widget.com/"));</script>
    <!-- END DOCUMENTATION RATING ANALYTICS -->
  </body>
</html>
