<!-- Set this_pages_navbar  -->












<!Doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="/css/style.css"/>
    <link rel="stylesheet" href="/css/plugins/offcanvas.css"/>
    <link href="https://www.projectcalico.org/wp-content/themes/dante/css/font-awesome.min.css" rel="stylesheet">
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/bootstrap/bootstrap.min.js"></script>
    <script src="/js/script.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52125893-4', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Security using Docker Labels and Calico Policy</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Security using Docker Labels and Calico Policy" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://docs.projectcalico.org/v2.6/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy" />
<meta property="og:url" content="https://docs.projectcalico.org/v2.6/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy" />
<script type="application/ld+json">
{"headline":"Security using Docker Labels and Calico Policy","@type":"WebPage","url":"https://docs.projectcalico.org/v2.6/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <section>
      <nav id="toplevel-nav" class="navbar navbar-default navbar-static-top">
        <div class="container">
          <div class="navbar-header">
            <!-- Hamburger menu for mobile -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#tigera-navbar" aria-expanded="false" aria-controls="tigera-navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <!-- Left brand image -->
            <a class="navbar-brand" href="https://projectcalico.org/">
              <img alt="Brand" src="/images/brand.png">
            </a>
          </div>
          <div id="tigera-navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://projectcalico.org">Home</a></li>
              <li class="active"><a href="https://projectcalico.org/resources"><span>Resources</span></a>
                <ul>
                    <li><a href="/latest/getting-started/"><i class="fa fa-tachometer" aria-hidden="true"></i> &nbsp; Getting Started</a></li>
                    <li><a href=""><i class="fa fa-book" aria-hidden="true"></i> &nbsp; Documentation</a></li>
                    <!--<li><a href="https://www.projectcalico.org/tutorials"><i class="fa fa-file-code-o" aria-hidden="true"></i> &nbsp; Tutorials &amp; Examples</a></li>
                    <li><a href=""><i class="fa fa-paper-plane-o" aria-hidden="true"></i> &nbsp; Online Workshops</a></li>-->
                    <li><a href="https://www.projectcalico.org/videos"><i class="fa fa-video-camera" aria-hidden="true"></i> &nbsp; Videos &amp; Webinars</a></li>
                    <li><a href="https://www.projectcalico.org/training"><i class="fa fa-graduation-cap" aria-hidden="true"></i> &nbsp; Training</a></li>
                    <li><a href="/latest/releases/"><i class="fa fa-clock-o" aria-hidden="true"></i> &nbsp; Releases</a></li>
                    <!-- <li><a href="/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li> -->
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/community">Community</a>
                <ul>
                    <li><a href="https://slack.projectcalico.org/"><i class="fa fa-slack" aria-hidden="true"></i> &nbsp; Slack</a></li>
                    <!--<li><a href="https://stackoverflow.com/questions/tagged/project-calico" target="_blank"><i class="fa fa-stack-overflow" aria-hidden="true"></i> &nbsp; StackOverflow</a></li>-->
                    <li><a href="https://www.projectcalico.org/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li>
                    <li><a href="https://www.projectcalico.org/community#events"><i class="fa fa-calendar" aria-hidden="true"></i> &nbsp; Upcoming Events</a></li>
                    <li><a href="https://www.projectcalico.org/newsletters"><i class="fa fa-envelope-o" aria-hidden="true"></i> &nbsp; Newsletter</a></li>
                    <li><a href="https://github.com/projectcalico" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> &nbsp; GitHub</a></li> 
                    <li><a href="https://www.projectcalico.org/jobs"><i class="fa fa-briefcase" aria-hidden="true"></i> &nbsp; Jobs</a></li>
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/mvp" style="font-weight: bold;">MVP</a></li>
              <li><a href="https://www.projectcalico.org/support">Support</a></li>
              <li class="hidden-xs"><a href="https://www.projectcalico.org/support">
                <img class="desktopImage" width="30" align="absmiddle" src="https://www.projectcalico.org/images/tigera_trans_sm.png" alt="Tigera"></a>
              </li>
            </ul>
            <form class="navbar-form visible-xs">
              <ul class="nav navbar-nav navbar-right">
                
                  <li >
                    <a href="/v2.3/introduction">Introduction</a>
                  </li>
                
                  <li  class="active">
                    <a href="/v2.3/getting-started">Getting Started</a>
                  </li>
                
                  <li >
                    <a href="/v2.3/usage">Usage</a>
                  </li>
                
                  <li >
                    <a href="/v2.3/reference">Reference</a>
                  </li>
                
                  <li >
                    <a href="/v2.3/releases">Releases</a>
                  </li>
                
              </ul>
            </form>
            <ul class="visible-xs nav navbar-nav navbar-right">
             <li class="dropdown">
               <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v2.3)<span class="caret"></span></a>
               <ul class="dropdown-menu">
                 <li><a href="/v2.6/introduction">v2.6 (latest)</a></li>
                 <li><a href="/v2.5/introduction">v2.5</a></li>
                 <li><a href="/v2.4/introduction">v2.4</a></li>
                 <li><a href="/v2.3/introduction">v2.3</a></li>
                 <li><a href="/v2.2/introduction">v2.2</a></li>
                 <li><a href="/v2.1/introduction">v2.1</a></li>
                 <li><a href="/v2.0/introduction">v2.0</a></li>
                 <li><a href="/v1.6/introduction">v1.6</a></li>
                 <li><a href="/v1.5/introduction">v1.5</a></li>
                 <li><a href="/v3.0/introduction">v3.0 (beta)</a></li>
                 <li><a href="/master/introduction">nightly</a></li>
                 <li role="separator" class="divider"></li>
               </ul>
             </li>
           </ul>
          </div>
        </div>
        <div id="navbar" class="navbar-inverse navbar-collapse collapse">
          <div class="container">
            <ul class="nav navbar-nav">
              
                <li>
                  <a href="/v2.3/introduction"><span>Introduction</span></a>
                </li>
              
                <li class="active">
                  <a href="/v2.3/getting-started"><span>Getting Started</span></a>
                </li>
              
                <li>
                  <a href="/v2.3/usage"><span>Usage</span></a>
                </li>
              
                <li>
                  <a href="/v2.3/reference"><span>Reference</span></a>
                </li>
              
                <li>
                  <a href="/v2.3/releases"><span>Releases</span></a>
                </li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v2.3)<span class="caret"></span></a>
                <ul class="dropdown-menu">
                   <li><a href="/v3.0/introduction">v3.0 (latest)</a></li>
                   <li><a href="/v2.6/introduction">v2.6</a></li>
                   <li><a href="/v2.5/introduction">v2.5</a></li>
                   <li><a href="/v2.4/introduction">v2.4</a></li>
                   <li><a href="/v2.3/introduction">v2.3</a></li>
                   <li><a href="/v2.2/introduction">v2.2</a></li>
                   <li><a href="/v2.1/introduction">v2.1</a></li>
                   <li><a href="/v2.0/introduction">v2.0</a></li>
                   <li><a href="/v1.6/introduction">v1.6</a></li>
                   <li><a href="/v1.5/introduction">v1.5</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="/master/introduction">nightly</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="row">
            <div class="col-sm-0"></div>
          </div>
        </div>
      </nav>
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
          <p class="pull-left visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
          </p>
          <div class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
            <div class="row">
              <script>
                (function() {
                  var cx = '015028447179048192876:xjzskk7awwe';
                  var gcse = document.createElement('script');
                  gcse.type = 'text/javascript';
                  gcse.async = true;
                  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                  var s = document.getElementsByTagName('script')[0];
                  s.parentNode.insertBefore(gcse, s);
                })();
              </script>
              <gcse:search></gcse:search>
            </div>
            <div id="sidebar">
            	

  
    
    
    <div class="link">
      <a class="item" data-title="Getting Started with Calico" href="/v2.3/getting-started/">
        Getting Started with Calico
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-kubernetes" aria-expanded="false" aria-controls="nav-kubernetes">
          Kubernetes
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-kubernetes">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/kubernetes/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-kubernetes-installation" aria-expanded="false" aria-controls="nav-kubernetes-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-kubernetes-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Introduction" href="/v2.3/getting-started/kubernetes/installation/">
        Introduction
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-kubernetes-installation-hosted-viakubectl" aria-expanded="false" aria-controls="nav-kubernetes-installation-hosted-viakubectl">
          Hosted (via kubectl)
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-kubernetes-installation-hosted-viakubectl">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Introduction" href="/v2.3/getting-started/kubernetes/installation/hosted/">
        Introduction
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Standard Hosted Install" href="/v2.3/getting-started/kubernetes/installation/hosted/hosted">
        Standard Hosted Install
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Kubeadm Hosted Install" href="/v2.3/getting-started/kubernetes/installation/hosted/kubeadm/">
        Kubeadm Hosted Install
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Kubernetes Datastore Hosted Install" href="/v2.3/getting-started/kubernetes/installation/hosted/kubernetes-datastore/">
        Kubernetes Datastore Hosted Install
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Integration Guide" href="/v2.3/getting-started/kubernetes/installation/integration">
        Integration Guide
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="AWS" href="/v2.3/getting-started/kubernetes/installation/aws">
        AWS
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="GCE" href="/v2.3/getting-started/kubernetes/installation/gce">
        GCE
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Vagrant/VirtualBox: CoreOS" href="/v2.3/getting-started/kubernetes/installation/vagrant/">
        Vagrant/VirtualBox: CoreOS
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-kubernetes-tutorials" aria-expanded="false" aria-controls="nav-kubernetes-tutorials">
          Tutorials
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-kubernetes-tutorials">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Using calicoctl" href="/v2.3/getting-started/kubernetes/tutorials/using-calicoctl">
        Using calicoctl
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Simple Policy Demo" href="/v2.3/getting-started/kubernetes/tutorials/simple-policy">
        Simple Policy Demo
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Stars Policy Demo" href="/v2.3/getting-started/kubernetes/tutorials/stars-policy/">
        Stars Policy Demo
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Advanced network policy" href="/v2.3/getting-started/kubernetes/tutorials/advanced-policy">
        Advanced network policy
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Troubleshooting / FAQ" href="/v2.3/getting-started/kubernetes/troubleshooting">
        Troubleshooting / FAQ
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Upgrade" href="/v2.3/getting-started/kubernetes/upgrade">
        Upgrade
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos" aria-expanded="false" aria-controls="nav-mesos">
          Mesos
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/mesos/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos-installation" aria-expanded="false" aria-controls="nav-mesos-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Requirements" href="/v2.3/getting-started/mesos/installation/prerequisites">
        Requirements
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Integration Guide" href="/v2.3/getting-started/mesos/installation/integration">
        Integration Guide
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos-installation-dcos" aria-expanded="false" aria-controls="nav-mesos-installation-dcos">
          DC/OS
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos-installation-dcos">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/mesos/installation/dc-os/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Universe Package Install" href="/v2.3/getting-started/mesos/installation/dc-os/framework">
        Universe Package Install
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Customize Universe Package Install" href="/v2.3/getting-started/mesos/installation/dc-os/custom">
        Customize Universe Package Install
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos-tutorials" aria-expanded="false" aria-controls="nav-mesos-tutorials">
          Tutorials
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos-tutorials">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Launching Tasks" href="/v2.3/getting-started/mesos/tutorials/launching-tasks">
        Launching Tasks
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Connecting to Tasks" href="/v2.3/getting-started/mesos/tutorials/connecting-tasks">
        Connecting to Tasks
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos-tutorials-configuringpolicy" aria-expanded="false" aria-controls="nav-mesos-tutorials-configuringpolicy">
          Configuring Policy
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos-tutorials-configuringpolicy">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Universal Containerizer" href="/v2.3/getting-started/mesos/tutorials/policy/universal-containerizer">
        Universal Containerizer
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Docker Containerizer" href="/v2.3/getting-started/mesos/tutorials/policy/docker-containerizer">
        Docker Containerizer
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-mesos-demos" aria-expanded="false" aria-controls="nav-mesos-demos">
          Demos
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-mesos-demos">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Vagrant Quickstart - Docker Containerizer" href="/v2.3/getting-started/mesos/vagrant/">
        Vagrant Quickstart - Docker Containerizer
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-docker" aria-expanded="false" aria-controls="nav-docker">
          Docker
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-docker">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/docker/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-docker-installation" aria-expanded="false" aria-controls="nav-docker-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-docker-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Requirements" href="/v2.3/getting-started/docker/installation/requirements">
        Requirements
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Manual" href="/v2.3/getting-started/docker/installation/manual">
        Manual
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Vagrant/VirtualBox: CoreOS" href="/v2.3/getting-started/docker/installation/vagrant-coreos/">
        Vagrant/VirtualBox: CoreOS
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Vagrant/VirtualBox: Ubuntu" href="/v2.3/getting-started/docker/installation/vagrant-ubuntu/">
        Vagrant/VirtualBox: Ubuntu
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-docker-tutorials" aria-expanded="false" aria-controls="nav-docker-tutorials">
          Tutorials
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-docker-tutorials">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Security using Calico Profiles" href="/v2.3/getting-started/docker/tutorials/security-using-calico-profiles">
        Security using Calico Profiles
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Security using Calico Profiles and Policy" href="/v2.3/getting-started/docker/tutorials/security-using-calico-profiles-and-policy">
        Security using Calico Profiles and Policy
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Security using Docker Labels and Calico Policy" href="/v2.3/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy">
        Security using Docker Labels and Calico Policy
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="IPAM" href="/v2.3/getting-started/docker/tutorials/ipam">
        IPAM
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-openstack" aria-expanded="false" aria-controls="nav-openstack">
          OpenStack
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-openstack">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/openstack/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-openstack-installation" aria-expanded="false" aria-controls="nav-openstack-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-openstack-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/openstack/installation/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Ubuntu" href="/v2.3/getting-started/openstack/installation/ubuntu">
        Ubuntu
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Red Hat Enterprise Linux 7" href="/v2.3/getting-started/openstack/installation/redhat">
        Red Hat Enterprise Linux 7
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Juju Charms" href="/v2.3/getting-started/openstack/installation/juju">
        Juju Charms
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Fuel" href="/v2.3/getting-started/openstack/installation/fuel">
        Fuel
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="DevStack" href="/v2.3/getting-started/openstack/installation/devstack">
        DevStack
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Chef" href="/v2.3/getting-started/openstack/installation/chef">
        Chef
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Upgrade" href="/v2.3/getting-started/openstack/upgrade">
        Upgrade
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Tutorials" href="/v2.3/getting-started/openstack/tutorials">
        Tutorials
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Troubleshooting" href="/v2.3/getting-started/openstack/verification">
        Troubleshooting
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="IP Addressing and Connectivity" href="/v2.3/getting-started/openstack/connectivity">
        IP Addressing and Connectivity
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Use of the Neutron API" href="/v2.3/getting-started/openstack/neutron-api">
        Use of the Neutron API
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-rkt" aria-expanded="false" aria-controls="nav-rkt">
          rkt
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-rkt">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/rkt/">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-rkt-installation" aria-expanded="false" aria-controls="nav-rkt-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-rkt-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Manual Installation" href="/v2.3/getting-started/rkt/installation/manual">
        Manual Installation
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Vagrant/VirtualBox: CoreOS" href="/v2.3/getting-started/rkt/installation/vagrant-coreos/">
        Vagrant/VirtualBox: CoreOS
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-rkt-tutorials" aria-expanded="false" aria-controls="nav-rkt-tutorials">
          Tutorials
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-rkt-tutorials">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Basic Network Isolation" href="/v2.3/getting-started/rkt/tutorials/basic">
        Basic Network Isolation
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Troubleshooting" href="/v2.3/getting-started/rkt/troubleshooting">
        Troubleshooting
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-hostprotection" aria-expanded="false" aria-controls="nav-hostprotection">
          Host Protection
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-hostprotection">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v2.3/getting-started/bare-metal/bare-metal">
        Overview
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-hostprotection-installation" aria-expanded="false" aria-controls="nav-hostprotection-installation">
          Installation
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-hostprotection-installation">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Installing Felix as a static binary" href="/v2.3/getting-started/bare-metal/bare-metal-install">
        Installing Felix as a static binary
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  


			</div>
          </div>
          <div class="col-xs-12 col-sm-8 col-md-9">
            <div id="content-main">
              <!-- TOP DOCUMENTATION PAGE NAVBAR -->
              <div style="text-align: left; padding: 18px 0 9px 0; min-width: 500px; overflow-x: hidden;">
              
              <a data-proofer-ignore href="https://github.com/projectcalico/calico/tree/master/v2.3/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy.md" style="color: #999; text-decoration: none; float: right;" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit this page</a></div>
              <!-- END TOP DOCUMENTATION PAGE NAVBAR -->
              
  <div class="alert alert-warning" role="alert">
    <strong>Warning:</strong> You are viewing the v2.3 docs. <a href="/latest">Click here to view the docs for the latest release.</a>
  </div>


              <h1>Security using Docker Labels and Calico Policy</h1>
              <h2 id="background">Background</h2>

<p>With Calico as a Docker network plugin, Calico can be configured to extract the
labels on a container and apply them to the workload endpoint for use with Calico
<a href="/v2.3/reference/calicoctl/resources/policy">policy</a>.
By default, Calico blocks all traffic unless it has been explicitly allowed
through configuration of the globally
defined policy which uses selectors to determine which subset of the policy is
applied to each container based on their labels.  This approach provides a
powerful way to group together all of your network Policy, makes it easy to
reuse policy in different networks, and makes it easier to define policy that
extends across different orchestration systems that use Calico.</p>

<p>When Calico is configured to use container labels, profiles are not created and 
have no impact on any container traffic.</p>

<h2 id="enabling-docker-networking-container-labels-policy">Enabling Docker Networking Container Labels Policy</h2>

<p>To enable labels to be used in Policy selectors the flag
<code class="highlighter-rouge">--use-docker-networking-container-labels</code> must be passed when starting
calico/node with the <code class="highlighter-rouge">calicoctl node run</code> command.  All calico/node instances
should be started with the flag to avoid a mix of labels and profiles.</p>

<h2 id="managing-calico-policy-for-a-network">Managing Calico policy for a network</h2>

<p>This section provides an example applying policy using the approach described
above once container labels are enabled.</p>

<p>We create a Calico-Docker network and use the <code class="highlighter-rouge">calicoctl</code> tool to set policies
that achieve the required isolation and allowances.</p>

<p>For the example let’s assume that we want to provide the following isolation
between a set of database containers and a set of frontend containers:</p>

<ul>
  <li>Frontend containers can only access the Database containers over TCP to port 3306.
For now we’ll assume no other connectivity is allowed to/from the frontend.</li>
  <li>Database containers have no isolation between themselves (to handle synchronization
within a cluster).  This could be improved by locking down the port ranges and
protocols, but for brevity we’ll just allow full access between database
containers.</li>
</ul>

<h3 id="global-policy-applied-through-label-selection">Global policy applied through label selection</h3>

<p>This example demonstrates using global selector-based policy with labels
extracted from the Docker containers.</p>

<h4 id="1-create-the-docker-network">1. Create the Docker network</h4>

<p>On any host in your Calico / Docker network, run the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker network create --driver calico --ipam-driver calico-ipam net1
</code></pre></div></div>

<h4 id="2-create-the-labeled-workloads">2. Create the Labeled Workloads</h4>

<p>We set labels on each container indicating the role, in our case frontend
or database.  The labels are applied directly to each container and must be
prefixed with <code class="highlighter-rouge">org.projectcalico.label.</code> for them to be extracted and applied
to the workload endpoint.</p>

<p>We have decided to use the label <code class="highlighter-rouge">role</code> indicating the role and a value of
either <code class="highlighter-rouge">frontend</code> or <code class="highlighter-rouge">database</code>.</p>

<p>Create the workloads as docker containers with appropriate labels.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run --label org.projectcalico.label.role=frontend --net net1 --name frontend-A -tid busybox
docker run --label org.projectcalico.label.role=database --net net1 --name database-A -tid busybox
</code></pre></div></div>

<h4 id="3-create-policy">3. Create policy</h4>

<p>Create the global policy to provide the required network isolation.</p>

<p>Policy resources are defined globally, and include a set of ingress and egress
rules and actions, where each rule can filter packets based on a variety
of source or destination attributes (which includes selector based filtering
using label selection).</p>

<p>Each policy resource also has a “main” selector that is used to determine which
endpoints the policy is applied to based on the applied labels.</p>

<p>We can use <code class="highlighter-rouge">calicoctl create</code> to create two new policies for this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &lt;&lt; EOF | calicoctl create -f -
- apiVersion: v1
  kind: policy
  metadata:
    name: database
  spec:
    order: 0
    selector: role == 'database'
    ingress:
    - action: allow
      protocol: tcp
      source:
        selector: role == 'frontend'
      destination:
        ports:
        -  3306
    - action: allow
      source:
        selector: role == 'database'
    egress:
    - action: allow
      destination:
        selector: role == 'database'
- apiVersion: v1
  kind: policy
  metadata:
    name: frontend
  spec:
    order: 0
    selector: role == 'frontend'
    egress:
    - action: allow
      protocol: tcp
      destination:
        selector: role == 'database'
        ports:
        -  3306
EOF
</code></pre></div></div>

<p>This works as follows:</p>

<ul>
  <li>Each database container is given the label <code class="highlighter-rouge">role = database</code>.</li>
  <li>Each frontend container in given the label <code class="highlighter-rouge">role = frontend</code>.</li>
  <li>The global policy resource “database” uses the selector <code class="highlighter-rouge">role == database</code> to
select containers with label <code class="highlighter-rouge">role = database</code> and applies ingress and egress
policy:
    <ul>
      <li>An ingress rule to allow TCP traffic to port 3306 from endpoints that have
the label <code class="highlighter-rouge">role = frontend</code> (i.e. from frontend containers since they are
the only ones with the label <code class="highlighter-rouge">role = frontend</code>)</li>
      <li>An ingress and egress rule to allow all traffic from and to endpoints that
have the label <code class="highlighter-rouge">role = database</code> (i.e. from database containers).</li>
    </ul>
  </li>
  <li>The global policy resource “frontend” uses the selector <code class="highlighter-rouge">role == frontend</code> to
select containers with label <code class="highlighter-rouge">role = frontend</code> and applies a single egress
rule to allow all TCP traffic to port 3306 on endpoints that have the label
<code class="highlighter-rouge">role = database</code> (i.e. to database containers)</li>
</ul>

<p>For details on all of the possible match criteria, see the
<a href="/v2.3/reference/calicoctl/resources/policy">policy resource</a>
documentation.</p>

<h2 id="multiple-networks">Multiple networks</h2>

<p>While some network providers tend to use multiple networks to enforce
isolation, Calico philosophy instead opts to put all containers in the same,
flat network, where they are separated by default, and then connect them using
Calico policy.  For this reason, Calico does not support attaching a container
to multiple docker networks.</p>

<p>Extending the previous example, suppose we introduce another label that is
used for system backups and that we want some of our database containers to
have the database label and a backup label (so they have database policy and
backup policy applied).</p>

<p>One approach for doing this is as follows:</p>

<ul>
  <li>Define a new label, say <code class="highlighter-rouge">backup = true</code> to indicate that a particular
endpoint should be allowed access to the backup network.</li>
  <li>Define global policy “backupnetwork” that allows full access between all
components with the  <code class="highlighter-rouge">backup = true</code> label.</li>
</ul>

<p>For your database containers that also need to be able to access the backup 
endpoints, launch them assigning both the <code class="highlighter-rouge">role = database</code> and <code class="highlighter-rouge">backup = true</code>
labels.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run --label org.projectcalico.label.role=database --label org.projectcalico.label.backup=true --net net1 --name database-B -tid busybox
</code></pre></div></div>

<p>Since containers started like this will have the two labels assigned to them,
they will pick up policy that selects both labels - in other words they will
have the locked down database access plus access to the backup network.</p>

<p>Obviously, the example of allowing full access between everything on the “backup”
network is probably a little too permissive, so you can lock down the access within
the backup network by modifying the global policy selected by the <code class="highlighter-rouge">backup = true</code>
label.</p>

              
              <!-- BOTTOM DOCUMENTATION PAGE NAVBAR -->
              <div style="margin-top: 60px; margin-bottom: 40px; padding-top: 20px; border-top: 1px solid #999; text-align: left; color: #999;">Rate this Page: <div class="rw-ui-container" style="margin-top: -5px;"></div> <a href="https://www.projectcalico.org/contact?type=docs&file=v2.3/getting-started/docker/tutorials/security-using-docker-labels-and-calico-policy.md" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i> Provide Feedback</a> <a href="https://www.projectcalico.org/community#slack" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-slack" aria-hidden="true"></i> Get Help via Slack</a> <a href="https://www.projectcalico.org/mvp" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-trophy" aria-hidden="true"></i> Ask our MVPs</a> <a href="https:/tigera.io/training" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Training</a></div>
              <!-- END BOTTOM DOCUMENTATION PAGE NAVBAR -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Start Visual Website Optimizer Asynchronous Code -->
    <script type='text/javascript'>
      var _vwo_code=(function(){
      var account_id=287573,
      settings_tolerance=2000,
      library_tolerance=2500,
      use_existing_jquery=false,
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
    </script>
    <!-- End Visual Website Optimizer Asynchronous Code -->
    <!-- DOCUMENTATION RATING ANALYTICS -->
   <script type="text/javascript">(function(d, t, e, m){
    // Async Rating-Widget initialization.
    window.RW_Async_Init = function(){
        RW.init({
            huid: "368439",
            uid: "33da22c0dff384767b5074aaf10ebc50",
            source: "website",
            options: {
                "advanced": {
					"font": {
						"color": "#999999"
					},
                    "layout": {
                        "align": {
                            "hor": "left"
                        }
                    },
                    "text": {
                        "rateThis": "Rate this"
                    }
                },
				"label": {
					"background": "#FFFFFF"
				},
				"reVote": true,
				"showInfo": false,
				/*"showTooltip": false,*/
				"hideRecommendations": false,
				"showReport": false,
				"showLoader": false,
                "style": "oxygen",
                "isDummy": false
            } 
        });
        RW.render();
    };
        // Append Rating-Widget JavaScript library.
    var rw, s = d.getElementsByTagName(e)[0], id = "rw-js",
        l = d.location, ck = "Y" + t.getFullYear() + 
        "M" + t.getMonth() + "D" + t.getDate(), p = l.protocol,
        f = ((l.search.indexOf("DBG=") > -1) ? "" : ".min"),
        a = ("https:" == p ? "secure." + m + "js/" : "js." + m);
    if (d.getElementById(id)) return;              
    rw = d.createElement(e);
    rw.id = id; rw.async = true; rw.type = "text/javascript";
    rw.src = p + "//" + a + "external" + f + ".js?ck=" + ck;
    s.parentNode.insertBefore(rw, s);
    }(document, new Date(), "script", "rating-widget.com/"));</script>
    <!-- END DOCUMENTATION RATING ANALYTICS -->
  </body>
</html>
