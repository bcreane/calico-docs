<!-- Set this_pages_navbar  -->












<!Doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="/css/style.css"/>
    <link rel="stylesheet" href="/css/plugins/offcanvas.css"/>
    <link href="https://www.projectcalico.org/wp-content/themes/dante/css/font-awesome.min.css" rel="stylesheet">
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/bootstrap/bootstrap.min.js"></script>
    <script src="/js/script.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52125893-4', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Configuring BGP Peers</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Configuring BGP Peers" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://docs.projectcalico.org/v3.0/usage/configuration/bgp" />
<meta property="og:url" content="https://docs.projectcalico.org/v3.0/usage/configuration/bgp" />
<script type="application/ld+json">
{"headline":"Configuring BGP Peers","@type":"WebPage","url":"https://docs.projectcalico.org/v3.0/usage/configuration/bgp","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <section>
      <nav id="toplevel-nav" class="navbar navbar-default navbar-static-top">
        <div class="container">
          <div class="navbar-header">
            <!-- Hamburger menu for mobile -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#tigera-navbar" aria-expanded="false" aria-controls="tigera-navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <!-- Left brand image -->
            <a class="navbar-brand" href="https://projectcalico.org/">
              <img alt="Brand" src="/images/brand.png">
            </a>
          </div>
          <div id="tigera-navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://projectcalico.org">Home</a></li>
              <li class="active"><a href="https://projectcalico.org/resources"><span>Resources</span></a>
                <ul>
                    <li><a href="/latest/getting-started/"><i class="fa fa-tachometer" aria-hidden="true"></i> &nbsp; Getting Started</a></li>
                    <li><a href=""><i class="fa fa-book" aria-hidden="true"></i> &nbsp; Documentation</a></li>
                    <!--<li><a href="https://www.projectcalico.org/tutorials"><i class="fa fa-file-code-o" aria-hidden="true"></i> &nbsp; Tutorials &amp; Examples</a></li>
                    <li><a href=""><i class="fa fa-paper-plane-o" aria-hidden="true"></i> &nbsp; Online Workshops</a></li>-->
                    <li><a href="https://www.projectcalico.org/videos"><i class="fa fa-video-camera" aria-hidden="true"></i> &nbsp; Videos &amp; Webinars</a></li>
                    <li><a href="https://www.projectcalico.org/training"><i class="fa fa-graduation-cap" aria-hidden="true"></i> &nbsp; Training</a></li>
                    <li><a href="/latest/releases/"><i class="fa fa-clock-o" aria-hidden="true"></i> &nbsp; Releases</a></li>
                    <!-- <li><a href="/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li> -->
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/community">Community</a>
                <ul>
                    <li><a href="https://slack.projectcalico.org/"><i class="fa fa-slack" aria-hidden="true"></i> &nbsp; Slack</a></li>
                    <!--<li><a href="https://stackoverflow.com/questions/tagged/project-calico" target="_blank"><i class="fa fa-stack-overflow" aria-hidden="true"></i> &nbsp; StackOverflow</a></li>-->
                    <li><a href="https://www.projectcalico.org/mvp"><i class="fa fa-star" aria-hidden="true"></i> &nbsp; MVP Program</a></li>
                    <li><a href="https://www.projectcalico.org/community#events"><i class="fa fa-calendar" aria-hidden="true"></i> &nbsp; Upcoming Events</a></li>
                    <li><a href="https://www.projectcalico.org/newsletters"><i class="fa fa-envelope-o" aria-hidden="true"></i> &nbsp; Newsletter</a></li>
                    <li><a href="https://github.com/projectcalico" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> &nbsp; GitHub</a></li> 
                    <li><a href="https://www.projectcalico.org/jobs"><i class="fa fa-briefcase" aria-hidden="true"></i> &nbsp; Jobs</a></li>
                    <li><a href="https://www.projectcalico.org/blog"><i class="fa fa-bookmark" aria-hidden="true"></i> &nbsp; Blog</a></li>
                </ul>
              </li>
              <li><a href="https://www.projectcalico.org/mvp" style="font-weight: bold;">MVP</a></li>
              <li><a href="https://www.projectcalico.org/support">Support</a></li>
              <li class="hidden-xs"><a href="https://www.projectcalico.org/support">
                <img class="desktopImage" width="30" align="absmiddle" src="https://www.projectcalico.org/images/tigera_trans_sm.png" alt="Tigera"></a>
              </li>
            </ul>
            <form class="navbar-form visible-xs">
              <ul class="nav navbar-nav navbar-right">
                
                  <li >
                    <a href="/v3.0/introduction">Introduction</a>
                  </li>
                
                  <li >
                    <a href="/v3.0/getting-started">Getting Started</a>
                  </li>
                
                  <li  class="active">
                    <a href="/v3.0/usage">Usage</a>
                  </li>
                
                  <li >
                    <a href="/v3.0/reference">Reference</a>
                  </li>
                
                  <li >
                    <a href="/v3.0/releases">Releases</a>
                  </li>
                
              </ul>
            </form>
            <ul class="visible-xs nav navbar-nav navbar-right">
             <li class="dropdown">
               <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v3.0)<span class="caret"></span></a>
               <ul class="dropdown-menu">
                 <li><a href="/v2.6/introduction">v2.6 (latest)</a></li>
                 <li><a href="/v2.5/introduction">v2.5</a></li>
                 <li><a href="/v2.4/introduction">v2.4</a></li>
                 <li><a href="/v2.3/introduction">v2.3</a></li>
                 <li><a href="/v2.2/introduction">v2.2</a></li>
                 <li><a href="/v2.1/introduction">v2.1</a></li>
                 <li><a href="/v2.0/introduction">v2.0</a></li>
                 <li><a href="/v1.6/introduction">v1.6</a></li>
                 <li><a href="/v1.5/introduction">v1.5</a></li>
                 <li><a href="/v3.0/introduction">v3.0 (beta)</a></li>
                 <li><a href="/master/introduction">nightly</a></li>
                 <li role="separator" class="divider"></li>
               </ul>
             </li>
           </ul>
          </div>
        </div>
        <div id="navbar" class="navbar-inverse navbar-collapse collapse">
          <div class="container">
            <ul class="nav navbar-nav">
              
                <li>
                  <a href="/v3.0/introduction"><span>Introduction</span></a>
                </li>
              
                <li>
                  <a href="/v3.0/getting-started"><span>Getting Started</span></a>
                </li>
              
                <li class="active">
                  <a href="/v3.0/usage"><span>Usage</span></a>
                </li>
              
                <li>
                  <a href="/v3.0/reference"><span>Reference</span></a>
                </li>
              
                <li>
                  <a href="/v3.0/releases"><span>Releases</span></a>
                </li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version (v3.0)<span class="caret"></span></a>
                <ul class="dropdown-menu">
                   <li><a href="/v3.0/introduction">v3.0 (latest)</a></li>
                   <li><a href="/v2.6/introduction">v2.6</a></li>
                   <li><a href="/v2.5/introduction">v2.5</a></li>
                   <li><a href="/v2.4/introduction">v2.4</a></li>
                   <li><a href="/v2.3/introduction">v2.3</a></li>
                   <li><a href="/v2.2/introduction">v2.2</a></li>
                   <li><a href="/v2.1/introduction">v2.1</a></li>
                   <li><a href="/v2.0/introduction">v2.0</a></li>
                   <li><a href="/v1.6/introduction">v1.6</a></li>
                   <li><a href="/v1.5/introduction">v1.5</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="/master/introduction">nightly</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="row">
            <div class="col-sm-0"></div>
          </div>
        </div>
      </nav>
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
          <p class="pull-left visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
          </p>
          <div class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
            <div class="row">
              <script>
                (function() {
                  var cx = '015028447179048192876:xjzskk7awwe';
                  var gcse = document.createElement('script');
                  gcse.type = 'text/javascript';
                  gcse.async = true;
                  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                  var s = document.getElementsByTagName('script')[0];
                  s.parentNode.insertBefore(gcse, s);
                })();
              </script>
              <gcse:search></gcse:search>
            </div>
            <div id="sidebar">
            	

  
    
    
    <div class="link">
      <a class="item" data-title="Using Calico" href="/v3.0/usage/">
        Using Calico
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl" aria-expanded="false" aria-controls="nav-calicoctl">
          calicoctl
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Installing calicoctl" href="/v3.0/usage/calicoctl/install">
        Installing calicoctl
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-calicoctl-configuringcalicoctl" aria-expanded="false" aria-controls="nav-calicoctl-configuringcalicoctl">
          Configuring calicoctl
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-calicoctl-configuringcalicoctl">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Overview" href="/v3.0/usage/calicoctl/configure/">
        Overview
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="etcd datastore options" href="/v3.0/usage/calicoctl/configure/etcd">
        etcd datastore options
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Kubernetes API datastore options" href="/v3.0/usage/calicoctl/configure/kdd">
        Kubernetes API datastore options
      </a>
    </div>
  


        </div>
      </div>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Running Calico with an init system" href="/v3.0/usage/configuration/as-service">
        Running Calico with an init system
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring BGP Peers" href="/v3.0/usage/configuration/bgp">
        Configuring BGP Peers
      </a>
    </div>
  

  
    
    <div>
      <div class="link">
        <span class="glyphicon glyphicon-chevron-right navbar-arrow"></span>
        <a role="button" data-toggle="collapse" href="#nav-routereflector" aria-expanded="false" aria-controls="nav-routereflector">
          Route Reflector
        </a>
      </div>
      <div class="section">
        <div class="collapse" id="nav-routereflector">
          

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring BIRD" href="/v3.0/usage/routereflector/bird-rr-config">
        Configuring BIRD
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="The calico/routereflector container" href="/v3.0/usage/routereflector/calico-routereflector">
        The calico/routereflector container
      </a>
    </div>
  


        </div>
      </div>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="IPv6" href="/v3.0/usage/ipv6">
        IPv6
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="External Connectivity" href="/v3.0/usage/external-connectivity">
        External Connectivity
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring IP-in-IP" href="/v3.0/usage/configuration/ip-in-ip">
        Configuring IP-in-IP
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring a Node IP Address and Subnet" href="/v3.0/usage/configuration/node">
        Configuring a Node IP Address and Subnet
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring MTU" href="/v3.0/usage/configuration/mtu">
        Configuring MTU
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Decommissioning a Node" href="/v3.0/usage/decommissioning-a-node">
        Decommissioning a Node
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Configuring Conntrack" href="/v3.0/usage/configuration/conntrack">
        Configuring Conntrack
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Troubleshooting" href="/v3.0/usage/troubleshooting/">
        Troubleshooting
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Logging" href="/v3.0/usage/troubleshooting/logging">
        Logging
      </a>
    </div>
  

  
    
    
    <div class="link">
      <a class="item" data-title="Frequently Asked Questions" href="/v3.0/usage/troubleshooting/faq">
        Frequently Asked Questions
      </a>
    </div>
  


			</div>
          </div>
          <div class="col-xs-12 col-sm-8 col-md-9">
            <div id="content-main">
              <!-- TOP DOCUMENTATION PAGE NAVBAR -->
              <div style="text-align: left; padding: 18px 0 9px 0; min-width: 500px; overflow-x: hidden;">
              
              <a data-proofer-ignore href="https://github.com/projectcalico/calico/tree/master/v3.0/usage/configuration/bgp.md" style="color: #999; text-decoration: none; float: right;" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit this page</a></div>
              <!-- END TOP DOCUMENTATION PAGE NAVBAR -->
              

              <h1>Configuring BGP Peers</h1>
              <p>This document describes the commands available in <code class="highlighter-rouge">calicoctl</code> for managing BGP.  It
is intended primarily for users who are running on private cloud
and would like to peer Calico with their underlying infrastructure.</p>

<p>This document covers configuration of:</p>

<ul>
  <li>Global default node AS Number</li>
  <li>The full node-to-node mesh</li>
  <li>Global BGP Peers</li>
  <li>Node-specific BGP peers</li>
</ul>

<h3 id="concepts">Concepts</h3>

<p><strong>Autonomous system (AS) number</strong></p>

<p>The global default node AS number is the AS number used by the BGP agent on a
Calico node when it has not been explicitly specified.  Setting this value
simplifies configuration when your network topology allows all of your Calico
nodes to use the same AS number.</p>

<p><strong>Node-to-node mesh</strong></p>

<p>The full node-to-node mesh option provides a mechanism to automatically
configure peering between all Calico nodes.  When enabled, each Calico node
automatically sets up a BGP peering with every other Calico node in the
network.  By default this is enabled.</p>

<p>The full node-to-node mesh provides a simple mechanism for auto-configuring
the BGP network in small scale deployments (say 50 nodes—although this limit
is not set in stone and Calico has been deployed with over 100 nodes in a full
mesh topology).</p>

<p>For large-scale deployments, or for deployments where you require a more specific
BGP topology (e.g., peering with ToR switches) the full node-to-node mesh should be
disabled and explicit BGP peers configured for your Calico nodes.  A BGP peer may 
be configured in your Calico network as a global BGP peer or a per-node BGP peer.</p>

<p><strong>Global BGP peers</strong></p>

<p>A global BGP peer is a BGP agent that peers with every Calico node in the
network.  A typical use case for a global peer might be a mid-scale
deployment where all of the Calico nodes are on the same L2 network and are
each peering with the same route reflector (or set of route reflectors).</p>

<p><strong>Per-node BGP peers</strong></p>

<p>At scale, different network topologies come in to play.  For example, in the
<a href="/v3.0/reference/private-cloud/l3-interconnect-fabric#the-as-per-rack-model">AS per Rack model</a>
discussed in the reference material, each Calico node peers with
a route reflector in the Top of Rack (ToR) switch.  In this case the BGP
peerings are configured on a per-node basis (i.e., these are node-specific
peers).  In the AS-per-rack model, each Calico node in a rack will be
configured with a node-specific peering to the ToR route reflector.</p>

<h3 id="configuring-the-default-node-as-number">Configuring the default node AS number</h3>

<p>When creating a Calico node, you can optionally specify an AS number to use for
the node.  If no AS number if specified, the node will use the global default
value.</p>

<p>See <a href="#example">Example</a> to set the global default AS number.
to set the global default AS number. If no value is configured, the default AS number is 64512.</p>

<p>If all of your Calico nodes are within the same AS, but you require a
different AS number to be used (e.g because you are peering with a border
router), changing the default AS number to the value you require eliminates
the need to explicitly set it on a per Calico node basis.  For more
complicated topologies where you are explicitly setting the AS number on each
node, the default value will not be used and therefore using this command is
not necessary.</p>

<blockquote class="alert alert-info">
  <p><strong>Note</strong>: Prior to version 2.0.0, <code class="highlighter-rouge">calicoctl</code> and <code class="highlighter-rouge">calico/node</code> set the global default
AS number to 64511. Updating your deployment from a pre-2.0.0 version to use
the 2.0.0+ <code class="highlighter-rouge">calicoctl</code> and <code class="highlighter-rouge">calico/node</code> container images will not affect the
global value that was previously set.</p>
</blockquote>

<h3 id="disabling-the-full-node-to-node-bgp-mesh">Disabling the full node-to-node BGP mesh</h3>

<p>If you are explicitly configuring the BGP topology for your Calico network,
you may wish to disable the full node-to-node mesh. See
<a href="#example">Example</a> 
for instructions to change the <code class="highlighter-rouge">nodeToNodeMeshEnabled</code> global BGP setting.</p>

<p>If you are building your network from scratch and do not need the full
node-to-node mesh we recommend turning off the mesh before configuring your
nodes.  If you are updating your network from a full-mesh topology to a
different topology (e.g. to start using a cluster of route reflectors to
increase scaling), configure the appropriate peers before disabling the mesh
to ensure continuity of service.</p>

<h4 id="example">Example</h4>

<p><strong>Prerequisite</strong>: <code class="highlighter-rouge">calicoctl</code> <a href="/v3.0/usage/calicoctl/install">installed</a> and <a href="/v3.0/usage/calicoctl/configure/">configured</a>.</p>

<p>To turn off the full BGP node-to-node mesh or to modify the global AS number, complete
the following steps.</p>

<ol>
  <li>
    <p>Issue the following command to determine if you have a <code class="highlighter-rouge">default</code> BGP configuration
resource.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> calicoctl get bgpconfig default
</code></pre></div>    </div>
  </li>
  <li>
    <p>If the resource <em>does</em> exist, skip to step 3. Otherwise, use the following 
command to create the resource. Before issuing the command, adjust the 
<code class="highlighter-rouge">nodeToNodeMeshEnabled</code> and <code class="highlighter-rouge">asNumber</code> lines and values as desired. 
Refer to <a href="/v3.0/reference/calicoctl/resources/bgpconfig">BGP Configuration Resource</a> for details about these settings.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cat &lt;&lt; EOF | calicoctl create -f -
 apiVersion: projectcalico.org/v3
 kind: BGPConfiguration
 metadata:
   name: default
 spec:
   logSeverityScreen: Info
   nodeToNodeMeshEnabled: false
   asNumber: 63400
</code></pre></div>    </div>

    <p>You’re done!</p>
  </li>
  <li>
    <p>If the resource <em>does</em> exist, use the following command to retrieve it and save it 
to a file.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> calicoctl get bgpconfig default -o yaml &gt; bgp.yaml
</code></pre></div>    </div>
  </li>
  <li>
    <p>Open the bgpconfig settings file in your favorite editor, modify 
the <code class="highlighter-rouge">nodeToNodeMeshEnabled</code> or <code class="highlighter-rouge">asNumber</code> as desired, and save the file. 
Refer to <a href="/v3.0/reference/calicoctl/resources/bgpconfig">BGP Configuration Resource</a> for details about these settings.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> vim bgp.yaml
</code></pre></div>    </div>
  </li>
  <li>
    <p>Replace the existing BGP configuration settings.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> calicoctl replace -f bgp.yaml
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="configuring-a-global-bgp-peer">Configuring a global BGP peer</h3>

<p>If your network topology includes BGP speakers that will be peered with <em>every</em>
Calico node in your deployment, you can use the <code class="highlighter-rouge">calicoctl</code> resource management
commands to set up the peering on your Calico nodes.  We refer to these types
of peer as global peers because they are configured in Calico once (globally)
and Calico will peer every Calico node with these peers.</p>

<p>Two situations where global BGP peer configuration is useful are (1) when adding
a border router that is peering into a full node-to-node mesh, or (2) configuring
a Calico network that uses one or two route reflectors to provide moderate
scale-out capabilities.  In the latter case, each Calico node would peer to
each of the route reflectors and the full node-to-node mesh would be
disabled.</p>

<h4 id="example-1">Example</h4>

<p>To add a global BGP peer at IP address 192.20.30.40 with AS number 64567 run
the following command on any node:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &lt;&lt; EOF | calicoctl create -f -
apiVersion: projectcalico.org/v3
kind: BGPPeer
metadata:
  name: bgppeer-global-3040
spec:
  peerIP: 192.20.30.40
  asNumber: 64567
EOF
</code></pre></div></div>

<p>To view the current list of BGP peers run the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>calicoctl get bgpPeer 
</code></pre></div></div>

<p>It should return something like the following.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                  PEERIP         NODE      ASN
bgppeer-global-3040   192.20.30.40   (global)  64567
</code></pre></div></div>

<p>To remove the global BGP peer that you just created run the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>calicoctl delete bgppeer bgppeer-global-3040
</code></pre></div></div>

<h3 id="configuring-a-node-specific-bgp-peer">Configuring a node-specific BGP peer</h3>

<p>If your network topology requires specific peerings for each Calico node, you
can use the <code class="highlighter-rouge">calicoctl</code> resource management commands to set up the peers
specific to a Calico node.  We refer to these as node-specific peers.</p>

<p>Configuring node-specific peers is necessary when the BGP topology is more
complicated and requires different peerings on different nodes.  For example,
the
<a href="/v3.0/reference/private-cloud/l3-interconnect-fabric#the-as-per-rack-model">AS per Rack model</a>
or
<a href="/v3.0/reference/private-cloud/l3-interconnect-fabric#the-as-per-compute-server-model">AS per Compute Server model</a>
described in the reference material.</p>

<h4 id="example-2">Example</h4>

<p>To add a BGP peer at IP address aa:bb::ff with AS number 64514,
peering with Calico node “node1”, run the following command on any node:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &lt;&lt; EOF | calicoctl create -f -
apiVersion: projectcalico.org/v3
kind: BGPPeer
metadata:
  name: bgppeer-node-aabbff
spec:
  peerIP: aa:bb::ff
  node: node1
  asNumber: 64514
EOF
</code></pre></div></div>

<p>To view the BGP peer resource that you just created, issue the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>calicoctl get bgpPeer bgppeer-node-aabbff
</code></pre></div></div>

<p>You should see your new BGP peer resource listed in the response.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                 PEERIP      NODE    ASN
bgppeer-node-aabbff  aa:bb::ff   node1   64514
</code></pre></div></div>

<p>To remove the BGP peer run the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>calicoctl delete bgppeer bgppeer-node-aabbff
</code></pre></div></div>

<h3 id="checking-the-status-of-the-bgp-peers">Checking the status of the BGP peers</h3>

<p>To display the status of all BGP peerings for a specific node, use the
<code class="highlighter-rouge">calicoctl node status</code> command.  This displays the status of all BGP peers for
that node—this includes the peers that are automatically configured as part
of the full node-to-node mesh and the explicitly configured global peers and
node specific peers.</p>

<p>Understanding the status of the BGP peerings is a useful first step in
diagnosing why routes may not be advertised across your network resulting in
incorrect connectivity between your workloads.</p>

<h4 id="example-3">Example</h4>

<p>To check the status of the peerings on Calico node <code class="highlighter-rouge">"node1"</code>, SSH into
<code class="highlighter-rouge">"node1"</code> and run the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo calicoctl node status
</code></pre></div></div>
<p>It should return something like the following.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Calico process is running.

IPv4 BGP status
+--------------+-------------------+-------+----------+-------------+
| PEER ADDRESS |     PEER TYPE     | STATE |  SINCE   |    INFO     |
+--------------+-------------------+-------+----------+-------------+
| 172.17.8.102 | node-to-node mesh | up    | 23:30:04 | Established |
| 10.20.30.40  |       global      | start | 16:28:38 |   Connect   |
|  192.10.0.0  |   node specific   | start | 16:28:57 |   Connect   |
+--------------+-------------------+-------+----------+-------------+

IPv6 BGP status
+--------------+-------------------+-------+----------+-------------+
| PEER ADDRESS |     PEER TYPE     | STATE |  SINCE   |    INFO     |
+--------------+-------------------+-------+----------+-------------+
| aa:bb::ff    | node-to-node mesh | up    | 16:17:26 | Established |
+--------------+-------------------+-------+----------+-------------+
</code></pre></div></div>

              
              <!-- BOTTOM DOCUMENTATION PAGE NAVBAR -->
              <div style="margin-top: 60px; margin-bottom: 40px; padding-top: 20px; border-top: 1px solid #999; text-align: left; color: #999;">Rate this Page: <div class="rw-ui-container" style="margin-top: -5px;"></div> <a href="https://www.projectcalico.org/contact?type=docs&file=v3.0/usage/configuration/bgp.md" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i> Provide Feedback</a> <a href="https://www.projectcalico.org/community#slack" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-slack" aria-hidden="true"></i> Get Help via Slack</a> <a href="https://www.projectcalico.org/mvp" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-trophy" aria-hidden="true"></i> Ask our MVPs</a> <a href="https:/tigera.io/training" style="margin-left: 30px; color: #999; text-decoration: none;" target="_blank"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Training</a></div>
              <!-- END BOTTOM DOCUMENTATION PAGE NAVBAR -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Start Visual Website Optimizer Asynchronous Code -->
    <script type='text/javascript'>
      var _vwo_code=(function(){
      var account_id=287573,
      settings_tolerance=2000,
      library_tolerance=2500,
      use_existing_jquery=false,
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
    </script>
    <!-- End Visual Website Optimizer Asynchronous Code -->
    <!-- DOCUMENTATION RATING ANALYTICS -->
   <script type="text/javascript">(function(d, t, e, m){
    // Async Rating-Widget initialization.
    window.RW_Async_Init = function(){
        RW.init({
            huid: "368439",
            uid: "33da22c0dff384767b5074aaf10ebc50",
            source: "website",
            options: {
                "advanced": {
					"font": {
						"color": "#999999"
					},
                    "layout": {
                        "align": {
                            "hor": "left"
                        }
                    },
                    "text": {
                        "rateThis": "Rate this"
                    }
                },
				"label": {
					"background": "#FFFFFF"
				},
				"reVote": true,
				"showInfo": false,
				/*"showTooltip": false,*/
				"hideRecommendations": false,
				"showReport": false,
				"showLoader": false,
                "style": "oxygen",
                "isDummy": false
            } 
        });
        RW.render();
    };
        // Append Rating-Widget JavaScript library.
    var rw, s = d.getElementsByTagName(e)[0], id = "rw-js",
        l = d.location, ck = "Y" + t.getFullYear() + 
        "M" + t.getMonth() + "D" + t.getDate(), p = l.protocol,
        f = ((l.search.indexOf("DBG=") > -1) ? "" : ".min"),
        a = ("https:" == p ? "secure." + m + "js/" : "js." + m);
    if (d.getElementById(id)) return;              
    rw = d.createElement(e);
    rw.id = id; rw.async = true; rw.type = "text/javascript";
    rw.src = p + "//" + a + "external" + f + ".js?ck=" + ck;
    s.parentNode.insertBefore(rw, s);
    }(document, new Date(), "script", "rating-widget.com/"));</script>
    <!-- END DOCUMENTATION RATING ANALYTICS -->
  </body>
</html>
